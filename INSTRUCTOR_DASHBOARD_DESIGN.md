# 講師用ダッシュボード設計書

## 概要

2名の講師が使用する講師用ダッシュボードの設計です。学生の進捗状況を一覧で確認し、成績管理や分析ができる機能を提供します。

## 機能要件

### 1. 認証機能
- **講師ログイン**: 講師IDとパスワードでログイン
- **2名の講師**: それぞれ個別のアカウントでログイン可能
- **セッション管理**: ログイン状態を保持

### 2. ダッシュボード画面

#### 2.1 全体統計（トップセクション）
- **総学生数**: 登録されている学生の総数
- **アクティブ学生数**: 過去7日以内にログインした学生数
- **平均完了症例数**: 全学生の平均完了症例数
- **全体平均精度**: 全学生の平均精度
- **本日のアクティビティ**: 本日のログイン数、完了症例数

#### 2.2 学生一覧テーブル
- **表示項目**:
  - 学生ID
  - 最終ログイン日時
  - 完了症例数 / 総症例数
  - 平均精度
  - 総セッション数
  - 最終セッション日時
  - アクション（詳細表示、進捗リセット）

- **機能**:
  - ページネーション（50件/ページ）
  - 検索機能（学生IDで検索）
  - ソート機能（各列でソート可能）
  - フィルタ機能（完了症例数、精度でフィルタ）

#### 2.3 詳細表示モーダル
- **学生の詳細情報**:
  - 基本情報（学生ID、登録日、最終ログイン日時）
  - 進捗詳細（症例別の精度、完了日時）
  - セッション履歴（日時、完了症例、精度）
  - 測定ログ（オプション）

### 3. 分析機能

#### 3.1 症例別分析
- **症例別の統計**:
  - 各症例（A-H）の完了学生数
  - 症例別の平均精度
  - 症例別の正答率分布

#### 3.2 時間別分析
- **日次/週次/月次のトレンド**:
  - ログイン数の推移
  - 完了症例数の推移
  - 平均精度の推移

### 4. エクスポート機能
- **CSVエクスポート**:
  - 全学生の進捗データをCSV形式でエクスポート
  - 学生ID、完了症例数、平均精度、最終ログイン日時を含む
  - Excelで開ける形式

### 5. 管理機能
- **学生管理**:
  - 学生の進捗データをリセット
  - 学生の削除（オプション）
- **講師管理**:
  - 講師アカウントの追加・削除（将来の拡張用）

## UIデザイン

### レイアウト
```
┌─────────────────────────────────────────────────┐
│ ヘッダー: HearSim 講師用ダッシュボード [ログアウト] │
├─────────────────────────────────────────────────┤
│ 全体統計カード（4-5個のカード）                    │
├─────────────────────────────────────────────────┤
│ 検索・フィルタバー                                │
│ [検索] [フィルタ] [CSV出力]                      │
├─────────────────────────────────────────────────┤
│ 学生一覧テーブル                                  │
│ ┌─────┬──────┬──────┬──────┬──────┐          │
│ │学生ID│完了数│平均精度│最終ログ│アクション│          │
│ ├─────┼──────┼──────┼──────┼──────┤          │
│ │ 111 │ 3/8 │  85% │ 1/15 │ [詳細]│          │
│ │ 112 │ 5/8 │  92% │ 1/14 │ [詳細]│          │
│ └─────┴──────┴──────┴──────┴──────┘          │
│ [前へ] [1] [2] [3] ... [次へ]                   │
├─────────────────────────────────────────────────┤
│ 症例別分析グラフ（オプション）                      │
└─────────────────────────────────────────────────┘
```

### カラースキーム
- **ヘッダー**: 濃い青（#1e40af）
- **統計カード**: 
  - 総学生数: 青（#3b82f6）
  - アクティブ: 緑（#10b981）
  - 平均精度: オレンジ（#f59e0b）
  - 本日の活動: 紫（#8b5cf6）
- **テーブル**: 白背景、交互にグレー背景
- **ボタン**: 
  - 詳細: 青
  - エクスポート: 緑
  - リセット: 赤

## 技術実装

### 1. ルーティング
- `/instructor` - 講師用ダッシュボード（メイン）
- `/instructor/login` - 講師ログイン画面

### 2. 認証
- Supabaseの`instructors`テーブルに講師情報を保存
- パスワードはハッシュ化して保存
- セッション管理はSupabase Authまたはローカルストレージ

### 3. データ取得
- Supabaseから学生データと進捗データを取得
- リアルタイム更新（オプション）または手動更新

### 4. コンポーネント構成
```
InstructorDashboard/
├── Login.jsx          # ログイン画面
├── Dashboard.jsx      # メインダッシュボード
├── components/
│   ├── StatsCards.jsx      # 統計カード
│   ├── StudentTable.jsx    # 学生一覧テーブル
│   ├── StudentDetail.jsx  # 学生詳細モーダル
│   ├── SearchBar.jsx      # 検索バー
│   └── ExportButton.jsx   # エクスポートボタン
└── utils/
    ├── auth.js            # 認証関連
    └── dataExport.js      # データエクスポート
```

## 実装の優先順位

### Phase 1（必須機能）
1. ✅ 講師ログイン機能
2. ✅ 全体統計の表示
3. ✅ 学生一覧テーブル
4. ✅ 学生詳細モーダル
5. ✅ CSVエクスポート

### Phase 2（推奨機能）
1. ⬜ 検索・フィルタ機能
2. ⬜ ソート機能
3. ⬜ ページネーション
4. ⬜ 症例別分析グラフ

### Phase 3（将来の拡張）
1. ⬜ 時間別分析
2. ⬜ リアルタイム更新
3. ⬜ 通知機能
4. ⬜ 講師管理機能

## データベース設計

### instructorsテーブル
```sql
CREATE TABLE instructors (
  id BIGSERIAL PRIMARY KEY,
  instructor_id TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  password_hash TEXT NOT NULL,
  email TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 既存テーブルの活用
- `students` - 学生情報
- `student_progress` - 進捗データ
- `measurements` - 測定ログ（オプション）

## セキュリティ

1. **認証**: パスワードはbcryptなどでハッシュ化
2. **RLS**: SupabaseのRLSポリシーで講師のみアクセス可能に設定
3. **セッション**: セッショントークンで管理
4. **ログ**: 講師の操作ログを記録（オプション）

## 使い方のイメージ

### 講師の1日の流れ
1. **朝**: ダッシュボードにログイン
2. **授業前**: 学生の進捗状況を確認
3. **授業中**: リアルタイムで進捗を確認（オプション）
4. **授業後**: 詳細な分析とCSVエクスポート
5. **週末**: 週次レポートの作成

### 画面遷移
```
ログイン画面
  ↓
ダッシュボード（全体統計 + 学生一覧）
  ↓
学生詳細モーダル（クリック時）
  ↓
CSVエクスポート（ボタンクリック）
```

## 実装開始の準備

実装を開始する前に確認すること：
1. ✅ Supabaseのテーブル作成
2. ✅ 講師アカウントの作成方法
3. ✅ データの構造確認
4. ✅ UI/UXの最終確認

---

**作成日**: 2024年1月
**対象**: 2名の講師による実証実験

