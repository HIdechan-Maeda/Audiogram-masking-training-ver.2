{"ast":null,"code":"var _jsxFileName = \"/Users/maedahidehiko/Documents/myAudiogram builder/src/AudiogramMaskingMVP.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useMemo, useRef, useLayoutEffect } from \"react\";\nimport { ResponsiveContainer, ComposedChart, XAxis, YAxis, CartesianGrid, Scatter, Line, LineChart } from \"recharts\";\n\n// Audiogram-first Masking Trainer (MVP v2.4.9)\n// - 1oct/grid x 10dB ticks; 1oct == 20dB; AC O/X, BC </> []\n// - Overlay blink; legend right-side panel; masking slider in header\n// - Fix: add targetMap + getThr() → resolves \"getThr is not defined\"\n\n// --- constants ---\n// Optional click→dB calibration offset (kept 0 as per spec 1/2/3)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CAL_OFFSET_DB = 0;\nconst BC_DISABLED = new Set([125, 8000]); // BCは125Hz/8000Hzは測定対象外\nconst FREQS = [125, 250, 500, 1000, 2000, 4000, 8000]; // 7 points -> 6 octaves\n// Slight domain padding to prevent edge clipping without changing visible tick positions\nconst X_DOMAIN = [0, FREQS.length - 1];\nconst Y_MIN = -10; // dB HL (top small, bottom large)\nconst Y_MAX = 120; // 10 dB ticks (render squares use 20 dB cells)\nconst CHART_SCALE = 1;\n// Geometry to force 1 octave (X) == 20 dB (Y)\nconst CELL_PX = 100; // px per 1 octave (== 20 dB) — larger, keeps square cells\nconst GRID_W = CELL_PX * (FREQS.length - 1); // 6 octaves\nconst GRID_H = CELL_PX * ((Y_MAX - Y_MIN) / 20); // vertical cells of 20 dB\nconst AXIS_LEFT = 64,\n  AXIS_RIGHT = 40,\n  AXIS_TOP = 20,\n  AXIS_BOTTOM = 48; // increase top to avoid clipping -10 dB tick\nconst CHART_MARGIN = {\n  top: AXIS_TOP,\n  right: AXIS_RIGHT,\n  bottom: AXIS_BOTTOM,\n  left: AXIS_LEFT\n}; // plotting box = GRID_W x GRID_H\n\n// Interaural Attenuation (IA): AC=50 dB, BC=0 dB\nconst IA = {\n  AC: 50,\n  BC: 0\n};\n\n// Max presentable levels (for Scale-Out logic)\nconst AC_MAX = {\n  125: 70,\n  250: 90,\n  500: 110,\n  1000: 110,\n  2000: 110,\n  4000: 110,\n  8000: 100\n};\nconst BC_MAX = {\n  250: 55,\n  500: 65,\n  1000: 70,\n  2000: 70,\n  4000: 60\n};\n\n// Marker size for AC/BC symbols (px). 24px target → radius 12, thicker stroke.\nconst MARK_R = 8; // radius (smaller markers)\nconst MARK_STROKE = 2;\n\n// Safe tick formatter for X axis (1 octave grid labels)\nfunction formatFreq(v) {\n  const i = Math.round(typeof v === 'number' ? v : 0);\n  return String(FREQS && FREQS[i] != null ? FREQS[i] : \"\");\n}\n\n// Legend / rendering series\nconst SERIES = [{\n  key: \"R-AC-U\",\n  label: \"Right AC (unmasked)\",\n  color: \"#ef4444\",\n  shape: \"O\"\n}, {\n  key: \"R-AC-M\",\n  label: \"Right AC (masked)\",\n  color: \"#b91c1c\",\n  shape: \"O\"\n}, {\n  key: \"L-AC-U\",\n  label: \"Left  AC (unmasked)\",\n  color: \"#3b82f6\",\n  shape: \"X\"\n}, {\n  key: \"L-AC-M\",\n  label: \"Left  AC (masked)\",\n  color: \"#1d4ed8\",\n  shape: \"X\"\n}, {\n  key: \"R-BC-U\",\n  label: \"Right BC (unmasked)\",\n  color: \"#ef4444\",\n  shape: \"lt\"\n}, {\n  key: \"R-BC-M\",\n  label: \"Right BC (masked)\",\n  color: \"#b91c1c\",\n  shape: \"lbracket\"\n}, {\n  key: \"L-BC-U\",\n  label: \"Left  BC (unmasked)\",\n  color: \"#3b82f6\",\n  shape: \"gt\"\n}, {\n  key: \"L-BC-M\",\n  label: \"Left  BC (masked)\",\n  color: \"#1d4ed8\",\n  shape: \"rbracket\"\n}];\n\n// --- preset helpers (compress verbose targets to keep file small) --- (compress verbose targets to keep file small) ---\nconst mk = (ear, transducer, list) => list.map(([freq, dB, so = false]) => ({\n  ear,\n  transducer,\n  masked: false,\n  freq,\n  dB,\n  ...(so ? {\n    so: true\n  } : {})\n}));\nconst preset = (name, parts) => ({\n  name,\n  targets: parts.flat()\n});\n\n// --- Preset cases (targets kept \"secret\"; used for overlay/validation only) ---\n// Each target: { ear:'R'|'L', transducer:'AC'|'BC', masked:false, freq:number, dB:number, so?:true }\nconst PRESET_A = preset('症例A', [mk('R', 'AC', [[125, 5], [250, 5], [500, 5], [1000, 5], [2000, 5], [4000, 0], [8000, 0]]), mk('L', 'AC', [[125, 10], [250, 10], [500, 5], [1000, 5], [2000, 5], [4000, 0], [8000, -5]]), mk('R', 'BC', [[250, 5], [500, 10], [1000, 5], [2000, 5], [4000, -5]]), mk('L', 'BC', [[250, 5], [500, 5], [1000, 0], [2000, 5], [4000, 0]])]);\nconst PRESET_B = preset('症例B', [\n// Right AC / BC\nmk('R', 'AC', [[125, 10], [500, 30], [1000, 50], [2000, 70], [4000, 90], [8000, 100]]), mk('R', 'BC', [[125, 10], [500, 30], [1000, 50], [2000, 70], [4000, 90], [8000, 100]]),\n// Left AC / BC\nmk('L', 'AC', [[125, 15], [250, 15], [500, 10], [1000, 10], [2000, 5], [4000, 5], [8000, 10]]), mk('L', 'BC', [[250, 15], [500, 10], [1000, 10], [2000, 5], [4000, 5]])]);\nconst PRESET_C = preset('症例C', [\n// Right AC / BC\nmk('R', 'AC', [[125, 20], [250, 20], [500, 15], [1000, 10], [2000, 10], [4000, 5], [8000, 5]]), mk('R', 'BC', [[250, 15], [500, 15], [1000, 10], [2000, 5], [4000, 10]]),\n// Left AC/BC (SO)\nmk('L', 'AC', [[125, 110, true], [250, 110, true], [500, 110, true], [1000, 110, true], [2000, 110, true], [4000, 110, true], [8000, 110, true]]), mk('L', 'BC', [[250, 110, true], [500, 110, true], [1000, 110, true], [2000, 110, true], [4000, 110, true]])]);\nconst PRESET_D = preset('症例D', [\n// Right AC / BC - 高音域の聴力低下\nmk('R', 'AC', [[125, 5], [250, 5], [500, 5], [1000, 10], [2000, 25], [4000, 45], [8000, 65]]), mk('R', 'BC', [[125, 5], [250, 5], [500, 5], [1000, 10], [2000, 20], [4000, 35], [8000, 50]]),\n// Left AC / BC - 低音域の聴力低下\nmk('L', 'AC', [[125, 25], [250, 30], [500, 20], [1000, 10], [2000, 5], [4000, 5], [8000, 10]]), mk('L', 'BC', [[125, 20], [250, 25], [500, 20], [1000, 10], [2000, 5], [4000, 5], [8000, 10]])]);\nconst PRESET_E = preset('症例E', [\n// Right AC / BC - 混合性難聴パターン\nmk('R', 'AC', [[125, 15], [250, 20], [500, 20], [1000, 30], [2000, 35], [4000, 35], [8000, 45]]), mk('R', 'BC', [[125, 10], [250, 15], [500, 20], [1000, 25], [2000, 30], [4000, 35], [8000, 40]]),\n// Left AC / BC - 感音性難聴パターン\nmk('L', 'AC', [[125, 40], [250, 45], [500, 40], [1000, 55], [2000, 60], [4000, 60], [8000, 70]]), mk('L', 'BC', [[125, 35], [250, 40], [500, 45], [1000, 50], [2000, 55], [4000, 60], [8000, 65]])]);\nconst PRESET_F = preset('症例F', [\n// Right AC / BC - 感音難聴（高音漸傾型）\nmk('R', 'AC', [[125, 10], [250, 15], [500, 20], [1000, 30], [2000, 45], [4000, 65], [8000, 80]]), mk('R', 'BC', [[125, 10], [250, 15], [500, 20], [1000, 30], [2000, 45], [4000, 65], [8000, 80]]),\n// Left AC / BC - 感音難聴（高音漸傾型、左右同じ）\nmk('L', 'AC', [[125, 10], [250, 15], [500, 20], [1000, 30], [2000, 45], [4000, 65], [8000, 80]]), mk('L', 'BC', [[125, 10], [250, 15], [500, 20], [1000, 30], [2000, 45], [4000, 65], [8000, 80]])]);\nconst PRESET_G = preset('症例G', [\n// Right AC / BC - 伝音難聴パターン\nmk('R', 'AC', [[125, 35], [250, 40], [500, 45], [1000, 50], [2000, 55], [4000, 60], [8000, 65]]), mk('R', 'BC', [[125, 5], [250, 5], [500, 5], [1000, 5], [2000, 5], [4000, 5], [8000, 5]]),\n// Left AC / BC - 混合性難聴パターン\nmk('L', 'AC', [[125, 25], [250, 30], [500, 35], [1000, 40], [2000, 45], [4000, 50], [8000, 55]]), mk('L', 'BC', [[125, 15], [250, 20], [500, 25], [1000, 30], [2000, 35], [4000, 40], [8000, 45]])]);\nconst PRESET_H = preset('症例H', [\n// Right AC / BC - 感音難聴（平坦型）\nmk('R', 'AC', [[125, 50], [250, 50], [500, 50], [1000, 50], [2000, 50], [4000, 50], [8000, 50]]), mk('R', 'BC', [[125, 50], [250, 50], [500, 50], [1000, 50], [2000, 50], [4000, 50], [8000, 50]]),\n// Left AC / BC - 感音難聴（平坦型、左右同じ）\nmk('L', 'AC', [[125, 50], [250, 50], [500, 50], [1000, 50], [2000, 50], [4000, 50], [8000, 50]]), mk('L', 'BC', [[125, 50], [250, 50], [500, 50], [1000, 50], [2000, 50], [4000, 50], [8000, 50]])]);\nfunction buildTargetsFromPreset(preset) {\n  return preset.targets.map(t => ({\n    ...t\n  }));\n}\n\n// helpers\nfunction clamp(n, lo, hi) {\n  return Math.max(lo, Math.min(hi, n));\n}\nfunction round5(n) {\n  return Math.round(n / 5) * 5;\n}\nfunction seriesKey(p) {\n  return `${p.ear}-${p.transducer}-${p.masked ? \"M\" : \"U\"}`;\n}\nfunction isResponse(points, t) {\n  return points.some(p => p.ear === t.ear && p.transducer === t.transducer && p.masked === t.masked && p.freq === t.freq && p.dB >= t.dB);\n}\n// PRESENTATION LIMIT (fix for ReferenceError: maxPresentable is not defined)\nfunction maxPresentable(transKey, f) {\n  var _AC_MAX$f, _BC_MAX$f;\n  return transKey === 'AC' ? (_AC_MAX$f = AC_MAX[f]) !== null && _AC_MAX$f !== void 0 ? _AC_MAX$f : 110 : (_BC_MAX$f = BC_MAX[f]) !== null && _BC_MAX$f !== void 0 ? _BC_MAX$f : 110;\n}\n\n// shape renderer (adds SO arrow if payload.so)\nfunction shapeRenderer(shape, color) {\n  return props => {\n    const {\n      cx,\n      cy,\n      payload\n    } = props;\n    const r = MARK_R;\n    const t = MARK_STROKE;\n    const so = payload && payload.so;\n    const Arrow = so ? /*#__PURE__*/_jsxDEV(\"g\", {\n      children: [/*#__PURE__*/_jsxDEV(\"line\", {\n        x1: cx,\n        y1: cy + r + 2,\n        x2: cx,\n        y2: cy + r + 10,\n        stroke: color,\n        strokeWidth: t\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n        x1: cx - 4,\n        y1: cy + r + 6,\n        x2: cx,\n        y2: cy + r + 10,\n        stroke: color,\n        strokeWidth: t\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n        x1: cx + 4,\n        y1: cy + r + 6,\n        x2: cx,\n        y2: cy + r + 10,\n        stroke: color,\n        strokeWidth: t\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this) : null;\n    switch (shape) {\n      case 'O':\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n            cx: cx,\n            cy: cy,\n            r: r,\n            stroke: color,\n            strokeWidth: t,\n            fill: \"white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this);\n      case 'X':\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          stroke: color,\n          strokeWidth: t,\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r,\n            y1: cy - r,\n            x2: cx + r,\n            y2: cy + r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r,\n            y1: cy + r,\n            x2: cx + r,\n            y2: cy - r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this);\n      case 'lbracket':\n        // [ (masked BC Right) - 左にずらす\n        const lbracketOffset = -3; // 右耳BCを左に3pxずらす\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          stroke: color,\n          strokeWidth: t,\n          fill: \"none\",\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r + lbracketOffset,\n            y1: cy - r,\n            x2: cx - r + lbracketOffset,\n            y2: cy + r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r + lbracketOffset,\n            y1: cy - r,\n            x2: cx - r / 3 + lbracketOffset,\n            y2: cy - r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r + lbracketOffset,\n            y1: cy + r,\n            x2: cx - r / 3 + lbracketOffset,\n            y2: cy + r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this);\n      case 'rbracket':\n        // ] (masked BC Left) - 右にずらす\n        const rbracketOffset = 3; // 左耳BCを右に3pxずらす\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          stroke: color,\n          strokeWidth: t,\n          fill: \"none\",\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx + r + rbracketOffset,\n            y1: cy - r,\n            x2: cx + r + rbracketOffset,\n            y2: cy + r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx + r + rbracketOffset,\n            y1: cy - r,\n            x2: cx + r / 3 + rbracketOffset,\n            y2: cy - r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx + r + rbracketOffset,\n            y1: cy + r,\n            x2: cx + r / 3 + rbracketOffset,\n            y2: cy + r\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this);\n      case 'lt':\n        // < (unmasked BC Right) - 左にずらす\n        const ltOffset = -3; // 右耳BCを左に3pxずらす\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          stroke: color,\n          strokeWidth: t,\n          fill: \"none\",\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx + r + ltOffset,\n            y1: cy - r,\n            x2: cx - r / 3 + ltOffset,\n            y2: cy\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx + r + ltOffset,\n            y1: cy + r,\n            x2: cx - r / 3 + ltOffset,\n            y2: cy\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this);\n      case 'gt':\n        // > (unmasked BC Left) - 右にずらす\n        const gtOffset = 3; // 左耳BCを右に3pxずらす\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          stroke: color,\n          strokeWidth: t,\n          fill: \"none\",\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r + gtOffset,\n            y1: cy - r,\n            x2: cx + r / 3 + gtOffset,\n            y2: cy\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: cx - r + gtOffset,\n            y1: cy + r,\n            x2: cx + r / 3 + gtOffset,\n            y2: cy\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this), Arrow]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: cx,\n          cy: cy,\n          r: r,\n          fill: color\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 16\n        }, this);\n    }\n  };\n}\n\n// Legend icon that reuses chart shapes instead of color squares\nfunction LegendMark({\n  shape,\n  color\n}) {\n  const size = MARK_R * 2 + 8; // padding around the symbol\n  const render = shapeRenderer(shape, color);\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: size,\n    height: size,\n    viewBox: `0 0 ${size} ${size}`,\n    \"aria-hidden\": true,\n    children: /*#__PURE__*/_jsxDEV(\"g\", {\n      transform: `translate(${size / 2}, ${size / 2})`,\n      children: render({\n        cx: 0,\n        cy: 0,\n        payload: {}\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n}\n_c = LegendMark;\nexport default function AudiogramMaskingMVP() {\n  _s();\n  var _generatedProblems$cu, _generatedProblems$cu2;\n  // 講習会用パスワード保護\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [password, setPassword] = useState('');\n  const TRAINING_PASSWORD = 'audiogram2024'; // 講習会用パスワード\n\n  // Basic UI state\n  const [ear, setEar] = useState('R'); // 'R' | 'L'\n  const [trans, setTrans] = useState('AC'); // 'AC' | 'BC'\n  const [masked, setMasked] = useState(false);\n  const [freq, setFreq] = useState(1000);\n  const [maskLevel, setMaskLevel] = useState(-15); // masking amount (dB); -15 means no masking\n  const [level, setLevel] = useState(30);\n  const [points, setPoints] = useState([]);\n  const [suppressLamp, setSuppressLamp] = useState(false); // 周波数切替時に一時的にランプ消灯\n  const [showLegend, setShowLegend] = useState(true); // ← FIX: define showLegend state\n\n  // Preset targets (secret answer)\n  const [targets, setTargets] = useState([]);\n  const [selectedPreset, setSelectedPreset] = useState('A');\n\n  // Log visualization\n  const [logData, setLogData] = useState(null);\n  const [showLogVisualization, setShowLogVisualization] = useState(false);\n\n  // Problem generation\n  const [showProblemGenerator, setShowProblemGenerator] = useState(false);\n  const [generatedProblems, setGeneratedProblems] = useState([]);\n  const [currentProblemIndex, setCurrentProblemIndex] = useState(0);\n\n  // Process log data for visualization\n  const processLogData = rawLogData => {\n    if (!rawLogData || !rawLogData.measurements) return null;\n    const measurements = rawLogData.measurements;\n    const processedData = {};\n\n    // Group by frequency and ear/transducer combination\n    measurements.forEach(measurement => {\n      const key = `${measurement.ear}-${measurement.transducer}-${measurement.freq}`;\n      if (!processedData[key]) {\n        processedData[key] = [];\n      }\n      processedData[key].push({\n        maskLevel: measurement.maskLevel,\n        threshold: measurement.dB,\n        timestamp: measurement.timestamp,\n        masked: measurement.masked\n      });\n    });\n\n    // Sort by mask level for each frequency group\n    Object.keys(processedData).forEach(key => {\n      processedData[key].sort((a, b) => a.maskLevel - b.maskLevel);\n    });\n    return processedData;\n  };\n\n  // Load log file\n  const handleLogFileLoad = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const jsonData = JSON.parse(e.target.result);\n        setLogData(jsonData);\n        setShowLogVisualization(true);\n      } catch (error) {\n        console.error('Error parsing log file:', error);\n        alert('ログファイルの読み込みに失敗しました。');\n      }\n    };\n    reader.readAsText(file);\n  };\n\n  // Generate random problems\n  const generateRandomProblems = () => {\n    const allPresets = [PRESET_A, PRESET_B, PRESET_C, PRESET_D, PRESET_E, PRESET_F, PRESET_G, PRESET_H];\n    const problems = [];\n    for (let i = 0; i < 10; i++) {\n      const randomPreset = allPresets[Math.floor(Math.random() * allPresets.length)];\n      problems.push({\n        id: i + 1,\n        preset: randomPreset,\n        question: `症例${String.fromCharCode(65 + allPresets.indexOf(randomPreset))}の聴力検査を実施してください。`,\n        description: `${randomPreset.name}の特徴的な聴力パターンを測定し、適切なマスキングを行ってください。`\n      });\n    }\n    setGeneratedProblems(problems);\n    setCurrentProblemIndex(0);\n    setShowProblemGenerator(true);\n  };\n\n  // Load current problem\n  const loadCurrentProblem = () => {\n    if (generatedProblems.length > 0 && currentProblemIndex < generatedProblems.length) {\n      const currentProblem = generatedProblems[currentProblemIndex];\n      setPoints([]);\n      setTargets(buildTargetsFromPreset(currentProblem.preset));\n    }\n  };\n\n  // Next problem\n  const nextProblem = () => {\n    if (currentProblemIndex < generatedProblems.length - 1) {\n      setCurrentProblemIndex(currentProblemIndex + 1);\n    }\n  };\n\n  // Previous problem\n  const previousProblem = () => {\n    if (currentProblemIndex > 0) {\n      setCurrentProblemIndex(currentProblemIndex - 1);\n    }\n  };\n\n  // Refs / layout\n  const containerRef = useRef(null);\n  const chartHostRef = useRef(null);\n  const overlayRef = useRef(null);\n  const plotCalRef = useRef({\n    scaleY: 1,\n    deltaTop: 0\n  });\n  // Fixed-size chart: plotting area derived from CELL_PX and margins (no ResponsiveContainer)\n  const chartW = GRID_W + AXIS_LEFT + AXIS_RIGHT; // widened right margin to avoid 8000 label clipping\n  const chartH = GRID_H + AXIS_TOP + AXIS_BOTTOM;\n\n  // Auto-hide legend if plotting box is too small (safety)\n  useEffect(() => {\n    setShowLegend(chartH * CHART_SCALE > 220);\n  }, [chartH]);\n\n  // --- Plot calibration: measure real grid box and align overlay ---\n  useLayoutEffect(() => {\n    const host = chartHostRef.current;\n    const ov = overlayRef.current;\n    if (!host || !ov) return;\n    const gridG = host.querySelector('g.recharts-cartesian-grid');\n    if (!gridG || !gridG.getBoundingClientRect) return;\n    const gridRect = gridG.getBoundingClientRect();\n    const ovRect = ov.getBoundingClientRect();\n    const scaleY = gridRect.height / Math.max(1, ovRect.height);\n    const deltaTop = gridRect.top - ovRect.top; // 上端の差（オーバーレイ→グリッド）\n    plotCalRef.current = {\n      scaleY,\n      deltaTop\n    };\n  });\n\n  // --- Dev sanity checks (non-intrusive) ---\n  useEffect(() => {\n    try {\n      var _tmap$get;\n      console.assert(Array.isArray(FREQS) && FREQS.length === 7, 'FREQS should have 7 items');\n      console.assert(SERIES.every(s => s.key && s.color && s.shape), 'SERIES entries must have key/color/shape');\n      const sampleTicks = Array.from({\n        length: FREQS.length\n      }, (_, i) => i).map(formatFreq);\n      console.assert(sampleTicks.every(t => String(t).length > 0), 'formatFreq should produce labels');\n      // quick unit-like check for getThr mapping using PRESET_A\n      const tmap = new Map();\n      PRESET_A.targets.filter(t => t.masked === false).forEach(t => {\n        var _AC_MAX$t$freq, _BC_MAX$t$freq;\n        const key = `${t.ear}|${t.transducer}|${t.freq}`;\n        const base = t.so ? (t.transducer === 'AC' ? (_AC_MAX$t$freq = AC_MAX[t.freq]) !== null && _AC_MAX$t$freq !== void 0 ? _AC_MAX$t$freq : 110 : (_BC_MAX$t$freq = BC_MAX[t.freq]) !== null && _BC_MAX$t$freq !== void 0 ? _BC_MAX$t$freq : 110) + 50 : t.dB;\n        tmap.set(key, {\n          dB: base\n        });\n      });\n      const k = 'R|AC|1000';\n      console.assert(((_tmap$get = tmap.get(k)) === null || _tmap$get === void 0 ? void 0 : _tmap$get.dB) === 5, 'getThr baseline sanity (R AC 1kHz should be 5 dB)');\n      // helpers\n      console.assert(round5(52) === 50 && round5(53) === 55, 'round5 should snap to nearest 5');\n      console.assert(maxPresentable('AC', 1000) === 110, 'AC max @1k should be 110');\n      // ensure getThr (component-scope) resolves with targetMap in place\n      console.assert(Number.isFinite(getThr('R', 'AC', 1000)), 'getThr should resolve for R AC 1k');\n\n      // === Added self-tests per spec (1) 5dB丸め, (2) -10/120クランプ, (3) 0/50/100整合 ===\n      // Pure mapping test with synthetic geometry\n      const yMin = -10,\n        yMax = 120,\n        gridH = yMax - yMin; // 1px == 1dB for synthetic\n      const mapYToDb = y => yMin + Math.max(0, Math.min(gridH, y)) / gridH * (yMax - yMin);\n      const assertNear5 = (val, expect) => console.assert(Math.abs(round5(val) - expect) <= 0, `round5(${val}) ~= ${expect}`);\n      assertNear5(mapYToDb(0), -10);\n      assertNear5(mapYToDb(gridH * 0.5), 55); // 中央\n      assertNear5(mapYToDb(gridH), 120);\n      // clamp extremes\n      console.assert(Math.min(yMax, Math.max(yMin, -15)) === -10, 'clamp top to -10dB');\n      console.assert(Math.min(yMax, Math.max(yMin, 130)) === 120, 'clamp bottom to 120dB');\n\n      // showLegend presence\n      console.assert(typeof showLegend === 'boolean', 'showLegend should be boolean');\n\n      // masking logic quick checks\n      const targets = PRESET_A.targets;\n      const localMap = new Map();\n      targets.filter(t => t.masked === false).forEach(t => {\n        var _AC_MAX$t$freq2, _BC_MAX$t$freq2;\n        const overMax = (t.transducer === 'AC' ? (_AC_MAX$t$freq2 = AC_MAX[t.freq]) !== null && _AC_MAX$t$freq2 !== void 0 ? _AC_MAX$t$freq2 : 110 : (_BC_MAX$t$freq2 = BC_MAX[t.freq]) !== null && _BC_MAX$t$freq2 !== void 0 ? _BC_MAX$t$freq2 : 110) + 50;\n        localMap.set(`${t.ear}|${t.transducer}|${t.freq}`, {\n          dB: t.so ? overMax : t.dB\n        });\n      });\n      const _getThr = (earKey, transKey, f) => {\n        var _localMap$get$dB, _localMap$get;\n        return (_localMap$get$dB = (_localMap$get = localMap.get(`${earKey}|${transKey}|${f}`)) === null || _localMap$get === void 0 ? void 0 : _localMap$get.dB) !== null && _localMap$get$dB !== void 0 ? _localMap$get$dB : Infinity;\n      };\n      const _hears = (earKey, transKey, f, L, maskedFlag, maskLvl) => {\n        var _IA$transKey;\n        const teThr = _getThr(earKey, transKey, f);\n        const testEarHeard = L >= teThr;\n        const nte = earKey === 'R' ? 'L' : 'R';\n        const ia = (_IA$transKey = IA[transKey]) !== null && _IA$transKey !== void 0 ? _IA$transKey : 0;\n        const leakedToNTE = L - ia;\n        const nteBC = _getThr(nte, 'BC', f);\n        const effectiveMask = maskedFlag && maskLvl > nteBC ? maskLvl : nteBC;\n        const crossHeard = leakedToNTE >= effectiveMask;\n        return testEarHeard || crossHeard;\n      };\n      console.assert(_hears('R', 'AC', 1000, 10, false, -15) === true, 'test-ear hears >= thr');\n      console.assert(_hears('R', 'AC', 2000, 70, true, 80) === true, 'effective masking keeps true via test-ear');\n    } catch (e) {\n      console.warn('Sanity check failed:', e);\n    }\n  }, [showLegend]);\n\n  // Overlay answer (blink)\n  const [showAnswer, setShowAnswer] = useState(false);\n  const [overMaskingWarning, setOverMaskingWarning] = useState(true); // オーバーマスキング警告のON/OFF\n  const [blinkOn, setBlinkOn] = useState(true);\n  useEffect(() => {\n    if (!showAnswer) return;\n    const id = setInterval(() => setBlinkOn(b => !b), 700);\n    return () => clearInterval(id);\n  }, [showAnswer]);\n\n  // Debug: log showAnswer state changes\n  useEffect(() => {\n    console.log('showAnswer changed:', showAnswer);\n  }, [showAnswer]);\n\n  // Keyboard: Arrow keys for navigation and level control\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const onKeyDown = e => {\n      const el = e.target;\n      const tag = el && el.tagName ? el.tagName.toUpperCase() : '';\n      const type = el && el.type ? String(el.type).toLowerCase() : '';\n      const isTypingField = tag === 'INPUT' && (type === 'text' || type === 'number' || type === 'search' || type === 'email' || type === 'password') || tag === 'TEXTAREA' || el && el.isContentEditable === true;\n      if (isTypingField) return;\n\n      // 周波数変更（左右キー）\n      if (e.key === 'ArrowRight') {\n        e.preventDefault();\n        console.log('右キー押下');\n        setFreq(prev => {\n          const idx = Math.max(0, FREQS.indexOf(prev));\n          const nextIdx = Math.min(FREQS.length - 1, idx + 1);\n          return FREQS[nextIdx];\n        });\n      }\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        console.log('左キー押下');\n        setFreq(prev => {\n          const idx = Math.max(0, FREQS.indexOf(prev));\n          const nextIdx = Math.max(0, idx - 1);\n          return FREQS[nextIdx];\n        });\n      }\n\n      // レベル調整（上下キー）- 上下を逆にして、自動打点\n      if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        console.log('上キー押下');\n        setLevel(prev => {\n          const newLevel = Math.min(Y_MAX, prev - 5); // 上キーで-5dB\n          setSuppressLamp(false);\n          // 自動で打点追加\n          setTimeout(() => {\n            addOrReplacePoint({\n              ear,\n              transducer: trans,\n              masked,\n              freq,\n              dB: round5(newLevel)\n            });\n          }, 50);\n          return newLevel;\n        });\n      }\n      if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        console.log('下キー押下');\n        setLevel(prev => {\n          const newLevel = Math.max(Y_MIN, prev + 5); // 下キーで+5dB\n          setSuppressLamp(false);\n          // 自動で打点追加\n          setTimeout(() => {\n            addOrReplacePoint({\n              ear,\n              transducer: trans,\n              masked,\n              freq,\n              dB: round5(newLevel)\n            });\n          }, 50);\n          return newLevel;\n        });\n      }\n\n      // Deleteキーで現在の打点削除\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        e.preventDefault();\n        removePointAtCurrent();\n      }\n    };\n    window.addEventListener('keydown', onKeyDown, {\n      capture: true\n    });\n    return () => {\n      window.removeEventListener('keydown', onKeyDown, {\n        capture: true\n      });\n    };\n  }, [ear, trans, masked, freq, level]);\n\n  // 周波数が変わったら一度ランプを消灯\n  useEffect(() => {\n    setSuppressLamp(true);\n  }, [freq]);\n  const freqIndex = useMemo(() => Math.max(0, FREQS.indexOf(freq)), [freq]);\n  function moveFreq(dir /* -1 | 1 */) {\n    let idx = clamp(freqIndex + dir, 0, FREQS.length - 1);\n    // BC時は125/8000Hzをスキップ\n    if (trans === 'BC') {\n      while (BC_DISABLED.has(FREQS[idx])) {\n        idx = clamp(idx + dir, 0, FREQS.length - 1);\n        if (idx === 0 || idx === FREQS.length - 1) break;\n      }\n    }\n    setFreq(FREQS[idx]);\n  }\n\n  // clicking on chart -> add/replace point for current ear/trans/masked+freq\n  function addOrReplacePoint(p) {\n    if (p.transducer === 'BC' && BC_DISABLED.has(p.freq)) {\n      setSuppressLamp(true);\n      return;\n    }\n    const p2 = {\n      ...p,\n      masked: p.masked\n    };\n    const max = maxPresentable(p2.transducer, p2.freq);\n    const atMax = p2.dB >= max;\n    const heardAtMax = hearsAtLevel(p2.ear, p2.transducer, p2.freq, max);\n    const so = atMax && !heardAtMax;\n    const p3 = {\n      ...p2,\n      dB: atMax ? max : p2.dB,\n      ...(so ? {\n        so: true\n      } : {})\n    };\n    setPoints(prev => {\n      const k = x => `${x.ear}|${x.transducer}|${x.masked ? 'M' : 'U'}|${x.freq}`;\n      const kp = k(p3);\n      const others = prev.filter(q => k(q) !== kp);\n      return [...others, p3].sort((a, b) => a.freq - b.freq || a.dB - b.dB);\n    });\n    setSuppressLamp(false);\n  }\n\n  // Precise hit: map overlay click to real grid using measured scale/offset\n  function handlePlotClick(e) {\n    if (trans === 'BC' && BC_DISABLED.has(freq)) {\n      setSuppressLamp(true);\n      return;\n    }\n    const ov = overlayRef.current;\n    if (!ov) return;\n    const ovRect = ov.getBoundingClientRect();\n\n    // クリック位置をオーバーレイ内の相対座標に変換\n    const clickX = e.clientX - ovRect.left;\n    const clickY = e.clientY - ovRect.top;\n\n    // Y軸の範囲を計算（オーディオグラムは上から下に-10dBから120dB）\n    const yRange = Y_MAX - Y_MIN; // 130dB\n    const yRatio = clickY / ovRect.height; // 0から1の比率\n\n    // RechartsのY軸はreversed=trueなので、座標変換を修正\n    // 上（yRatio=0）が120dB、下（yRatio=1）が-10dB\n    let dBraw = Y_MIN + yRatio * yRange;\n    dBraw += CAL_OFFSET_DB; // optional small offset (kept 0 by default)\n    const dBclamped = clamp(round5(dBraw), Y_MIN, Y_MAX);\n    const max = maxPresentable(trans, freq);\n    const atMax = dBclamped >= max;\n    const heardAtMax = hearsAtLevel(ear, trans, freq, max);\n    const so = atMax && !heardAtMax;\n    const p = {\n      ear,\n      transducer: trans,\n      masked,\n      freq,\n      dB: atMax ? max : dBclamped,\n      ...(so ? {\n        so: true\n      } : {})\n    };\n    addOrReplacePoint(p);\n    setLevel(p.dB);\n    setSuppressLamp(false);\n  }\n  function removePointAtCurrent() {\n    setPoints(prev => prev.filter(q => !(q.ear === ear && q.transducer === trans && q.freq === freq && q.masked === masked)));\n  }\n  function clearAll() {\n    setPoints([]);\n  }\n\n  // ---- Target lookup for cross-hearing & lamp logic ----\n  const targetMap = useMemo(() => {\n    const map = new Map();\n    (targets || []).forEach(t => {\n      var _AC_MAX$t$freq3, _BC_MAX$t$freq3;\n      if (!t || t.masked !== false || typeof t.freq !== 'number') return;\n      const overMax = (t.transducer === 'AC' ? (_AC_MAX$t$freq3 = AC_MAX[t.freq]) !== null && _AC_MAX$t$freq3 !== void 0 ? _AC_MAX$t$freq3 : 110 : (_BC_MAX$t$freq3 = BC_MAX[t.freq]) !== null && _BC_MAX$t$freq3 !== void 0 ? _BC_MAX$t$freq3 : 110) + 50;\n      const dB = t.so ? overMax : t.dB;\n      map.set(`${t.ear}|${t.transducer}|${t.freq}`, {\n        dB\n      });\n    });\n    return map;\n  }, [targets]);\n\n  // オーバーマスキング検出\n  const isOverMasking = useMemo(() => {\n    if (!masked || !overMaskingWarning) return false;\n    const testEarThreshold = getThr(ear, trans, freq);\n    if (testEarThreshold === Infinity) {\n      return false;\n    }\n\n    // マスキングの上限 = 測定耳閾値 + 50dB\n    const maskingLimit = testEarThreshold + 50;\n\n    // マスキングレベルが上限を超えている場合\n    return maskLevel > maskingLimit;\n  }, [masked, maskLevel, ear, trans, freq, overMaskingWarning, targetMap]);\n  function getThr(earKey, transKey, f) {\n    const key = `${earKey}|${transKey}|${f}`;\n    const v = targetMap.get(key);\n    if (v && typeof v.dB === 'number') {\n      // SO（Scale-Out）の場合は最大値+50dBを返す\n      if (v.dB >= 110) {\n        var _AC_MAX$f2, _BC_MAX$f2;\n        return (transKey === 'AC' ? (_AC_MAX$f2 = AC_MAX[f]) !== null && _AC_MAX$f2 !== void 0 ? _AC_MAX$f2 : 110 : (_BC_MAX$f2 = BC_MAX[f]) !== null && _BC_MAX$f2 !== void 0 ? _BC_MAX$f2 : 110) + 50;\n      }\n      return v.dB;\n    }\n    return Infinity; // missing → treat as no response\n  }\n  function hearsAtLevel(earKey, transKey, f, L) {\n    var _IA$transKey2;\n    const teThr = getThr(earKey, transKey, f);\n    const testEarHeard = L >= teThr;\n    const nte = earKey === 'R' ? 'L' : 'R';\n    const ia = (_IA$transKey2 = IA[transKey]) !== null && _IA$transKey2 !== void 0 ? _IA$transKey2 : 0;\n    const leakedToNTE = L - ia;\n\n    // マスキングの基本原理：\n    // AC測定時：非測定耳のBC閾値と比較\n    // BC測定時：非測定耳のBC閾値と比較\n    const nteBC = getThr(nte, 'BC', f);\n\n    // マスキングの計算\n    let effectiveMask = nteBC;\n    if (masked && maskLevel > nteBC) {\n      // マスキングレベルが非測定耳BC閾値より高い場合\n      effectiveMask = maskLevel;\n    }\n    const crossHeard = leakedToNTE >= effectiveMask;\n    return testEarHeard || crossHeard;\n  }\n\n  // series data (user)\n  const seriesData = useMemo(() => {\n    const m = {};\n    SERIES.forEach(s => m[s.key] = []);\n    points.forEach(p => {\n      const key = seriesKey(p);\n      if (!m[key]) m[key] = [];\n      const i = Math.max(0, FREQS.indexOf(p.freq));\n      const xIdx = i;\n      m[key].push({\n        x: xIdx,\n        idx: i,\n        y: p.dB,\n        ...(p.so ? {\n          so: true\n        } : {})\n      });\n    });\n    return m;\n  }, [points]);\n\n  // AC lines (connect) — break at Scale-Out and at gaps\n  const acLineData = useMemo(() => {\n    const out = {};\n    SERIES.filter(s => s.key.includes('-AC-')).forEach(s => {\n      out[s.key] = FREQS.map((_, i) => ({\n        x: i,\n        y: null\n      }));\n      const pts = seriesData[s.key] || [];\n      pts.forEach(p => {\n        const i = p.x;\n        if (!p || typeof i !== 'number') return;\n        out[s.key][i] = p.so ? {\n          x: i,\n          y: null\n        } : {\n          x: i,\n          y: p.y\n        };\n      });\n    });\n    return out;\n  }, [seriesData]);\n\n  // Build answer overlay series from loaded targets (markers)\n  const answerSeriesData = useMemo(() => {\n    const m = {};\n    SERIES.forEach(s => m[s.key] = []);\n    (targets || []).forEach(t => {\n      var _AC_MAX$t$freq4, _BC_MAX$t$freq4;\n      if (t.transducer === 'BC' && BC_DISABLED.has(t.freq)) return;\n      const i = Math.max(0, FREQS.indexOf(t.freq));\n      const xIdx = i;\n      const isSO = !!t.so;\n      const yVal = isSO ? t.transducer === 'AC' ? (_AC_MAX$t$freq4 = AC_MAX[t.freq]) !== null && _AC_MAX$t$freq4 !== void 0 ? _AC_MAX$t$freq4 : 110 : (_BC_MAX$t$freq4 = BC_MAX[t.freq]) !== null && _BC_MAX$t$freq4 !== void 0 ? _BC_MAX$t$freq4 : 110 : t.dB;\n      // BCの場合は常にmaskedのキーを使用\n      const key = t.transducer === 'BC' ? `${t.ear}-${t.transducer}-M` : `${t.ear}-${t.transducer}-${t.masked ? 'M' : 'U'}`;\n      m[key] = m[key] || [];\n      m[key].push({\n        x: xIdx,\n        y: yVal,\n        ...(isSO ? {\n          so: true\n        } : {})\n      });\n    });\n    console.log('answerSeriesData generated:', m);\n    return m;\n  }, [targets]);\n\n  // Answer AC lines: break at SO and at gaps by inserting null placeholders\n  const answerLineData = useMemo(() => {\n    const out = {};\n    SERIES.filter(s => s.key.includes('-AC-')).forEach(s => {\n      out[s.key] = FREQS.map((_, i) => ({\n        x: i,\n        y: null\n      }));\n      const pts = answerSeriesData[s.key] || [];\n      pts.forEach(p => {\n        const i = p.x;\n        if (!p || typeof i !== 'number') return;\n        out[s.key][i] = p.so ? {\n          x: i,\n          y: null\n        } : {\n          x: i,\n          y: p.y\n        };\n      });\n    });\n    return out;\n  }, [answerSeriesData]);\n\n  // Response lamp (current condition vs target >= OR cross-hearing)\n  const currentTarget = useMemo(() => (targets || []).find(x => x.ear === ear && x.transducer === trans && x.masked === false && x.freq === freq), [targets, ear, trans, freq]);\n  const lampOn = useMemo(() => {\n    if (!currentTarget) return false;\n    if (suppressLamp) return false; // 抑制中は消灯\n    const L = round5(level);\n\n    // クロスヒアリングを考慮した応答判定\n    return hearsAtLevel(ear, trans, freq, L);\n  }, [currentTarget, level, ear, trans, freq, masked, maskLevel, targetMap, suppressLamp]);\n\n  // オーバーマスキングを考慮した実際の閾値を取得\n  function getActualThreshold(earKey, transKey, f) {\n    const baseThreshold = getThr(earKey, transKey, f);\n    if (masked && transKey === 'BC') {\n      // BC測定時のオーバーマスキング計算\n      // マスキングの上限 = 測定耳BC閾値 + 50dB\n      const maskingLimit = baseThreshold + 50;\n      if (maskLevel > maskingLimit) {\n        // オーバーマスキング発生\n        const overMasking = maskLevel - maskingLimit;\n        return baseThreshold + overMasking;\n      }\n    }\n    return baseThreshold;\n  }\n\n  // パスワード認証画面\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full min-h-screen flex items-center justify-center bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full mx-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-2xl font-bold text-gray-900 mb-2\",\n            children: \"\\u30AA\\u30FC\\u30C7\\u30A3\\u30AA\\u30B0\\u30E9\\u30E0\\u8B1B\\u7FD2\\u4F1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 781,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600\",\n            children: \"\\u53C2\\u52A0\\u7528\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 782,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 780,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 786,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              value: password,\n              onChange: e => setPassword(e.target.value),\n              onKeyPress: e => e.key === 'Enter' && password === TRAINING_PASSWORD && setIsAuthenticated(true),\n              className: \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n              placeholder: \"\\u8B1B\\u7FD2\\u4F1A\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 787,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 785,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => password === TRAINING_PASSWORD && setIsAuthenticated(true),\n            disabled: password !== TRAINING_PASSWORD,\n            className: \"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed\",\n            children: \"\\u53C2\\u52A0\\u3059\\u308B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 796,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 784,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 text-center text-sm text-gray-500\",\n          children: \"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9: audiogram2024\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 804,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 779,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 778,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full min-h-screen p-6 md:p-10 bg-gray-50 text-gray-900\",\n    ref: containerRef,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto grid gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"flex flex-col md:flex-row md:items-end md:justify-between gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-2xl md:text-3xl font-bold\",\n            children: \"Simple Audiogram builder (Masking simulator)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 817,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 mt-1\",\n            children: \"\\u8B1B\\u7FD2\\u4F1A\\u53C2\\u52A0\\u4E2D - \\u8B1B\\u5E2B\\u306E\\u6307\\u793A\\u306B\\u5F93\\u3063\\u3066\\u64CD\\u4F5C\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 818,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 816,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setIsAuthenticated(false),\n          className: \"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\",\n          children: \"\\u9000\\u51FA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 820,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 815,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 border border-blue-200 rounded-2xl p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-start gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-blue-600 text-xl\",\n            children: \"\\uD83D\\uDCDA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 831,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-semibold text-blue-800\",\n              children: \"\\u8B1B\\u7FD2\\u4F1A\\u53C2\\u52A0\\u8005\\u306E\\u65B9\\u3078\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 833,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-blue-700 mt-1\",\n              children: [\"\\u2022 \\u8B1B\\u5E2B\\u306E\\u6307\\u793A\\u306B\\u5F93\\u3063\\u3066\\u75C7\\u4F8B\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 835,\n                columnNumber: 39\n              }, this), \"\\u2022 \\u5404\\u81EA\\u3067\\u64CD\\u4F5C\\u3057\\u306A\\u304C\\u3089\\u5B66\\u7FD2\\u3092\\u9032\\u3081\\u3066\\u304F\\u3060\\u3055\\u3044\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 836,\n                columnNumber: 38\n              }, this), \"\\u2022 \\u8CEA\\u554F\\u304C\\u3042\\u308B\\u5834\\u5408\\u306F\\u30C1\\u30E3\\u30C3\\u30C8\\u3067\\u304A\\u805E\\u304D\\u304F\\u3060\\u3055\\u3044\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 837,\n                columnNumber: 39\n              }, this), \"\\u2022 \\u6B63\\u7B54\\u8868\\u793A\\u306F\\u8B1B\\u5E2B\\u306E\\u6307\\u793A\\u304C\\u3042\\u308B\\u307E\\u3067\\u5F85\\u3063\\u3066\\u304F\\u3060\\u3055\\u3044\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 832,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 829,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-green-50 border border-green-200 rounded-2xl p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-start gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-green-600 text-xl\",\n            children: \"\\u2328\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 847,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-semibold text-green-800\",\n              children: \"\\u30AD\\u30FC\\u30DC\\u30FC\\u30C9\\u64CD\\u4F5C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 849,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-green-700 mt-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u30AB\\u30FC\\u30BD\\u30EB\\u30AD\\u30FC:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 17\n              }, this), \" \\u2190\\u2192\\u5468\\u6CE2\\u6570\\u5909\\u66F4 | \\u2191-5dB\\u8ABF\\u6574(\\u81EA\\u52D5\\u6253\\u70B9) | \\u2193+5dB\\u8ABF\\u6574(\\u81EA\\u52D5\\u6253\\u70B9)\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 81\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u524A\\u9664:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 852,\n                columnNumber: 17\n              }, this), \" Delete\\u30AD\\u30FC\\u307E\\u305F\\u306FBackspace\\u30AD\\u30FC\\u3067\\u73FE\\u5728\\u306E\\u6253\\u70B9\\u524A\\u9664\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 852,\n                columnNumber: 68\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u30DE\\u30A6\\u30B9:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 853,\n                columnNumber: 17\n              }, this), \" \\u30C1\\u30E3\\u30FC\\u30C8\\u30AF\\u30EA\\u30C3\\u30AF\\u3067\\u3082\\u6253\\u70B9\\u53EF\\u80FD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 850,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 848,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 846,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 845,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-600\",\n            children: \"\\u75C7\\u4F8B\\u30D7\\u30EA\\u30BB\\u30C3\\u30C8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 862,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"border rounded-xl px-2 py-1 text-sm\",\n            value: selectedPreset,\n            onChange: e => setSelectedPreset(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"A\",\n              children: \"\\u75C7\\u4F8BA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 864,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"B\",\n              children: \"\\u75C7\\u4F8BB\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 865,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"C\",\n              children: \"\\u75C7\\u4F8BC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 866,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"D\",\n              children: \"\\u75C7\\u4F8BD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 867,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"E\",\n              children: \"\\u75C7\\u4F8BE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 868,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"F\",\n              children: \"\\u75C7\\u4F8BF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 869,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"G\",\n              children: \"\\u75C7\\u4F8BG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 870,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"H\",\n              children: \"\\u75C7\\u4F8BH\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 871,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 863,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-2 rounded-xl bg-teal-600 text-white text-sm\",\n            onClick: () => {\n              const p = selectedPreset === 'A' ? PRESET_A : selectedPreset === 'B' ? PRESET_B : selectedPreset === 'C' ? PRESET_C : selectedPreset === 'D' ? PRESET_D : selectedPreset === 'E' ? PRESET_E : selectedPreset === 'F' ? PRESET_F : selectedPreset === 'G' ? PRESET_G : PRESET_H;\n              setPoints([]);\n              setTargets(buildTargetsFromPreset(p));\n            },\n            children: \"LOAD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 873,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-400\",\n            children: \"\\u203B LOAD\\u3067\\u30D7\\u30ED\\u30C3\\u30C8\\u306F\\u81EA\\u52D5\\u30AF\\u30EA\\u30A2\\u3002\\u6B63\\u7B54\\u306F\\u753B\\u9762\\u306B\\u8868\\u793A\\u3057\\u307E\\u305B\\u3093\\uFF08\\u7167\\u5408/\\u30AA\\u30FC\\u30D0\\u30FC\\u30EC\\u30A4\\u7528\\uFF09\\u3002\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 878,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 861,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 860,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-600\",\n            children: \"\\u554F\\u984C\\u751F\\u6210\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 885,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-2 rounded-xl bg-green-600 text-white text-sm\",\n            onClick: generateRandomProblems,\n            children: \"\\u30E9\\u30F3\\u30C0\\u30E0\\u554F\\u984C\\u751F\\u6210\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 886,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-2 rounded-xl bg-blue-600 text-white text-sm\",\n            onClick: () => setShowProblemGenerator(!showProblemGenerator),\n            disabled: generatedProblems.length === 0,\n            children: showProblemGenerator ? '問題非表示' : '問題表示'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 892,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-400\",\n            children: \"\\u203B \\u30E9\\u30F3\\u30C0\\u30E0\\u306B\\u75C7\\u4F8B\\u3092\\u9078\\u629E\\u3057\\u3066\\u554F\\u984C\\u3092\\u751F\\u6210\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 899,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 884,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 883,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-600\",\n            children: \"\\u30ED\\u30B0\\u8996\\u899A\\u5316\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 906,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \".json\",\n            onChange: handleLogFileLoad,\n            className: \"text-sm\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 907,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-2 rounded-xl bg-purple-600 text-white text-sm\",\n            onClick: () => setShowLogVisualization(!showLogVisualization),\n            disabled: !logData,\n            children: showLogVisualization ? 'グラフ非表示' : 'グラフ表示'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 913,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-400\",\n            children: \"\\u203B JSON\\u30ED\\u30B0\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u8AAD\\u307F\\u8FBC\\u3093\\u3067\\u30DE\\u30B9\\u30AD\\u30F3\\u30B0\\u91CF\\u3068\\u8074\\u529B\\u30EC\\u30D9\\u30EB\\u306E\\u95A2\\u4FC2\\u3092\\u8996\\u899A\\u5316\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 920,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 905,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 904,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid md:grid-cols-6 gap-4 text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(Control, {\n            label: \"Ear\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  setEar('R');\n                  setFreq(1000);\n                  setSuppressLamp(true);\n                },\n                className: `px-3 py-2 rounded-lg border text-base ${ear === 'R' ? 'bg-red-600 text-white border-red-600' : 'bg-white text-red-600 border-red-600'}`,\n                children: \"Right\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 929,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  setEar('L');\n                  setFreq(1000);\n                  setSuppressLamp(true);\n                },\n                className: `px-3 py-2 rounded-lg border text-base ${ear === 'L' ? 'bg-blue-600 text-white border-blue-600' : 'bg-white text-blue-600 border-blue-600'}`,\n                children: \"Left\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 930,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 928,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 927,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Control, {\n            label: \"Transducer\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(TinyToggle, {\n                active: trans === 'AC',\n                onClick: () => {\n                  setTrans('AC');\n                  setFreq(1000);\n                  setSuppressLamp(true);\n                },\n                children: \"AC\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 935,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TinyToggle, {\n                active: trans === 'BC',\n                onClick: () => {\n                  setTrans('BC');\n                  setFreq(1000);\n                  setSuppressLamp(true);\n                },\n                children: \"BC\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 936,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 934,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 933,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Control, {\n            label: \"Frequency\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => moveFreq(-1),\n                className: \"px-2 py-1 rounded-lg border\",\n                children: \"\\u25C0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 941,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-mono w-24 text-center\",\n                children: [freq, \" Hz\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 942,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => moveFreq(1),\n                className: \"px-2 py-1 rounded-lg border\",\n                children: \"\\u25B6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 943,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 940,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 939,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Control, {\n            label: \"Level (dB HL)\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: Y_MIN,\n                max: Y_MAX,\n                step: 5,\n                value: level,\n                onChange: e => {\n                  setLevel(parseInt(e.target.value));\n                  setSuppressLamp(false);\n                },\n                className: \"w-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 948,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-mono w-16 text-right\",\n                children: level\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 949,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 947,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 946,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Control, {\n            label: \"\\u6253\\u70B9\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => addOrReplacePoint({\n                  ear,\n                  transducer: trans,\n                  masked,\n                  freq,\n                  dB: round5(level)\n                }),\n                className: \"px-3 py-2 rounded-xl bg-indigo-600 text-white\",\n                children: \"\\u8FFD\\u52A0/\\u66F4\\u65B0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 954,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: removePointAtCurrent,\n                className: \"px-3 py-2 rounded-xl bg-white border\",\n                children: \"\\u524A\\u9664\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 955,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: clearAll,\n                className: \"px-3 py-2 rounded-xl bg-white border\",\n                children: \"\\u5168\\u30AF\\u30EA\\u30A2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 956,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 953,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 952,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 926,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-500 mt-2\",\n          children: [\"\\u203B \\u30C1\\u30E3\\u30FC\\u30C8\\u3092\\u30AF\\u30EA\\u30C3\\u30AF\\u3057\\u3066\\u3082\\u6253\\u70B9\\u3067\\u304D\\u307E\\u3059\\uFF08\\u73FE\\u5728\\u9078\\u629E\\u4E2D\\u306EEar/Transducer/Masking\\u30FB\\u5468\\u6CE2\\u6570\\u5217\\u306B\\u5BFE\\u3057\\u3066\\uFF09\\u3002\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 961,\n            columnNumber: 73\n          }, this), \"\\u203B \\u30AD\\u30FC\\u30DC\\u30FC\\u30C9\\u64CD\\u4F5C: \\u2190\\u2192\\u5468\\u6CE2\\u6570\\u5909\\u66F4 | \\u2191-5dB\\u8ABF\\u6574(\\u81EA\\u52D5\\u6253\\u70B9) | \\u2193+5dB\\u8ABF\\u6574(\\u81EA\\u52D5\\u6253\\u70B9) | Delete\\u6253\\u70B9\\u524A\\u9664\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 960,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 925,\n        columnNumber: 9\n      }, this), isOverMasking && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-50 border border-red-200 rounded-2xl p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-600 text-xl\",\n            children: \"\\u26A0\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 970,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-semibold text-red-800\",\n              children: \"\\u30AA\\u30FC\\u30D0\\u30FC\\u30DE\\u30B9\\u30AD\\u30F3\\u30B0\\u306E\\u53EF\\u80FD\\u6027\\u3042\\u308A\\uFF01\\uFF01\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 972,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 971,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 969,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 968,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-semibold\",\n            children: \"Audiogram\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 981,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex items-center gap-2 px-2 py-1 rounded-full border ${lampOn ? 'bg-orange-50 border-orange-300' : 'bg-white border-gray-300'}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `w-3.5 h-3.5 rounded-full ${lampOn ? 'bg-orange-500' : 'bg-gray-300'}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 983,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs\",\n              children: \"\\u5FDC\\u7B54\\u30E9\\u30F3\\u30D7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 984,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 982,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-gray-600\",\n              children: [\"Masking (NTE: \", ear === 'R' ? 'L' : 'R', \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 987,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(TinyToggle, {\n                active: !masked,\n                onClick: () => {\n                  setMasked(false);\n                  setMaskLevel(-15);\n                },\n                children: \"Unmasked\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 989,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TinyToggle, {\n                active: masked,\n                onClick: () => {\n                  setMasked(true);\n                  if (maskLevel < 0) setMaskLevel(0);\n                },\n                children: \"Masked\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 990,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 988,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 min-w-[180px]\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"range\",\n                min: -15,\n                max: 110,\n                step: 5,\n                value: maskLevel,\n                onChange: e => setMaskLevel(parseInt(e.target.value)),\n                className: \"w-40\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 993,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-16 text-right text-xs font-mono\",\n                children: [maskLevel, \" dB\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 994,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 992,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowAnswer(a => !a),\n              className: `px-2 py-1 rounded-lg border text-xs ${showAnswer ? 'bg-emerald-600 text-white border-emerald-600' : 'bg-white text-gray-800'}`,\n              title: \"\\u6B63\\u7B54\\uFF08\\u30AA\\u30FC\\u30D0\\u30FC\\u30EC\\u30A4\\uFF09\\u3092\\u8868\\u793A/\\u975E\\u8868\\u793A\",\n              children: showAnswer ? '正答表示: ON' : '正答表示: OFF'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 996,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setOverMaskingWarning(w => !w),\n              className: `px-2 py-1 rounded-lg border text-xs ${overMaskingWarning ? 'bg-yellow-600 text-white border-yellow-600' : 'bg-white text-gray-800'}`,\n              title: \"\\u30AA\\u30FC\\u30D0\\u30FC\\u30DE\\u30B9\\u30AD\\u30F3\\u30B0\\u8B66\\u544A\\u306EON/OFF\",\n              children: overMaskingWarning ? '警告: ON' : '警告: OFF'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 999,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 986,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 980,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-stretch gap-0 items-start\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            ref: chartHostRef,\n            className: \"relative chart-host\",\n            style: {\n              width: chartW,\n              height: chartH,\n              overflow: 'visible'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              ref: overlayRef,\n              className: \"absolute\",\n              style: {\n                left: CHART_MARGIN.left,\n                top: CHART_MARGIN.top,\n                width: GRID_W,\n                height: GRID_H,\n                cursor: 'crosshair',\n                zIndex: 10,\n                pointerEvents: 'auto',\n                background: 'transparent'\n              },\n              onPointerUp: handlePlotClick,\n              onPointerDown: e => e.preventDefault()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1007,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ComposedChart, {\n              width: chartW,\n              height: chartH,\n              data: [],\n              margin: CHART_MARGIN,\n              children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n                strokeDasharray: \"3 3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1015,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n                type: \"number\",\n                dataKey: \"x\",\n                domain: X_DOMAIN,\n                ticks: Array.from({\n                  length: FREQS.length\n                }, (_, i) => i),\n                tickFormatter: formatFreq,\n                label: {\n                  value: 'Frequency (Hz) - 1 octave/grid',\n                  position: 'bottom',\n                  offset: 6,\n                  style: {\n                    fontSize: 18\n                  }\n                },\n                tick: {\n                  fontSize: 18\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1016,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n                type: \"number\",\n                dataKey: \"y\",\n                domain: [Y_MIN, Y_MAX],\n                ticks: Array.from({\n                  length: (Y_MAX - Y_MIN) / 10 + 1\n                }, (_, i) => Y_MIN + i * 10),\n                reversed: true,\n                tickMargin: 6,\n                label: {\n                  value: 'Hearing Level (dB HL) - 10 dB/grid',\n                  angle: -90,\n                  position: 'left',\n                  offset: 0,\n                  dy: -100,\n                  style: {\n                    fontSize: 18\n                  }\n                },\n                tick: {\n                  fontSize: 18\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1017,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Line, {\n                data: [{\n                  x: 0,\n                  y: 0\n                }, {\n                  x: FREQS.length - 1,\n                  y: 0\n                }],\n                dataKey: \"y\",\n                xAxisId: 0,\n                yAxisId: 0,\n                type: \"monotone\",\n                dot: false,\n                stroke: \"#94a3b8\",\n                strokeWidth: 2\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1018,\n                columnNumber: 19\n              }, this), SERIES.map(s => /*#__PURE__*/_jsxDEV(Scatter, {\n                name: s.label,\n                data: (seriesData[s.key] || []).map(d => ({\n                  x: d.x,\n                  y: d.y,\n                  ...(d.so ? {\n                    so: true\n                  } : {})\n                })),\n                fill: s.color,\n                shape: shapeRenderer(s.shape, s.color)\n              }, s.key, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1021,\n                columnNumber: 21\n              }, this)), SERIES.filter(s => s.key.includes('-AC-')).map(s => /*#__PURE__*/_jsxDEV(Line, {\n                data: acLineData[s.key] || [],\n                dataKey: \"y\",\n                stroke: s.color,\n                strokeWidth: 2,\n                dot: false,\n                strokeDasharray: s.key.startsWith('L-') ? '6 4' : undefined,\n                type: \"linear\",\n                connectNulls: false\n              }, `line-${s.key}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1025,\n                columnNumber: 21\n              }, this)), showAnswer && SERIES.map(s => /*#__PURE__*/_jsxDEV(Scatter, {\n                name: `${s.label} (answer)`,\n                data: answerSeriesData[s.key] || [],\n                fill: \"#10b981\",\n                shape: props => /*#__PURE__*/_jsxDEV(\"g\", {\n                  style: {\n                    opacity: blinkOn ? 1 : 0\n                  },\n                  children: shapeRenderer(s.shape, '#10b981')(props)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1029,\n                  columnNumber: 151\n                }, this),\n                isAnimationActive: false\n              }, `ans-${s.key}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1029,\n                columnNumber: 21\n              }, this)), showAnswer && SERIES.filter(s => s.key.includes('-AC-')).map(s => /*#__PURE__*/_jsxDEV(Line, {\n                data: answerLineData[s.key] || [],\n                dataKey: \"y\",\n                stroke: \"#10b981\",\n                strokeOpacity: 0.35,\n                isAnimationActive: false,\n                strokeWidth: 2,\n                dot: false,\n                strokeDasharray: '4 6',\n                type: \"linear\",\n                connectNulls: false\n              }, `ans-line-${s.key}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1032,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1014,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1006,\n            columnNumber: 13\n          }, this), showLegend && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"shrink-0 pl-2\",\n            style: {\n              display: 'flex',\n              alignItems: 'flex-start'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"space-y-0.5 text-[16px] leading-tight pr-1\",\n              children: SERIES.map(s => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"flex items-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(LegendMark, {\n                  shape: s.shape,\n                  color: s.color\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1041,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: s.label\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1042,\n                  columnNumber: 23\n                }, this)]\n              }, s.key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1040,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1038,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1037,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1005,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 979,\n        columnNumber: 9\n      }, this), showProblemGenerator && generatedProblems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-semibold mb-4\",\n          children: [\"\\u554F\\u984C \", currentProblemIndex + 1, \" / \", generatedProblems.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1054,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-blue-800 mb-2\",\n            children: (_generatedProblems$cu = generatedProblems[currentProblemIndex]) === null || _generatedProblems$cu === void 0 ? void 0 : _generatedProblems$cu.question\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1056,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-blue-700 text-sm\",\n            children: (_generatedProblems$cu2 = generatedProblems[currentProblemIndex]) === null || _generatedProblems$cu2 === void 0 ? void 0 : _generatedProblems$cu2.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1057,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1055,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\",\n            onClick: loadCurrentProblem,\n            children: \"\\u3053\\u306E\\u554F\\u984C\\u3092\\u958B\\u59CB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1060,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700\",\n            onClick: previousProblem,\n            disabled: currentProblemIndex === 0,\n            children: \"\\u524D\\u306E\\u554F\\u984C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1066,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700\",\n            onClick: nextProblem,\n            disabled: currentProblemIndex === generatedProblems.length - 1,\n            children: \"\\u6B21\\u306E\\u554F\\u984C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1073,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1059,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1053,\n        columnNumber: 11\n      }, this), showLogVisualization && logData && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-semibold mb-4\",\n          children: \"\\u30DE\\u30B9\\u30AD\\u30F3\\u30B0\\u91CF\\u3068\\u8074\\u529B\\u30EC\\u30D9\\u30EB\\u306E\\u95A2\\u4FC2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1087,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(LogVisualizationCharts, {\n          logData: logData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1088,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1086,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 814,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 813,\n    columnNumber: 5\n  }, this);\n}\n\n// Log Visualization Component\n_s(AudiogramMaskingMVP, \"g6TTCBtfFk4KkqNStCo7LNEbeRg=\");\n_c2 = AudiogramMaskingMVP;\nfunction LogVisualizationCharts({\n  logData\n}) {\n  _s2();\n  const processedData = useMemo(() => {\n    if (!logData || !logData.measurements) return {};\n    const measurements = logData.measurements;\n    const processedData = {};\n\n    // Group by frequency and ear/transducer combination\n    measurements.forEach(measurement => {\n      const key = `${measurement.ear}-${measurement.transducer}-${measurement.freq}`;\n      if (!processedData[key]) {\n        processedData[key] = [];\n      }\n      processedData[key].push({\n        maskLevel: measurement.maskLevel,\n        threshold: measurement.dB,\n        timestamp: measurement.timestamp,\n        masked: measurement.masked\n      });\n    });\n\n    // Sort by mask level for each frequency group\n    Object.keys(processedData).forEach(key => {\n      processedData[key].sort((a, b) => a.maskLevel - b.maskLevel);\n    });\n    return processedData;\n  }, [logData]);\n  const frequencies = [125, 250, 500, 1000, 2000, 4000, 8000];\n  const colors = {\n    'R-AC': '#ef4444',\n    'L-AC': '#3b82f6',\n    'R-BC': '#f59e0b',\n    'L-BC': '#10b981'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: frequencies.map(freq => {\n      const chartsForFreq = [];\n\n      // Find all ear-transducer combinations for this frequency\n      Object.keys(processedData).forEach(key => {\n        const [ear, transducer, freqStr] = key.split('-');\n        if (parseInt(freqStr) === freq && processedData[key].length > 0) {\n          const earTransKey = `${ear}-${transducer}`;\n          chartsForFreq.push({\n            key: key,\n            earTrans: earTransKey,\n            data: processedData[key],\n            color: colors[earTransKey] || '#6b7280'\n          });\n        }\n      });\n      if (chartsForFreq.length === 0) return null;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border rounded-lg p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-md font-semibold mb-3\",\n          children: [freq, \" Hz\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1157,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",\n          children: chartsForFreq.map(({\n            key,\n            earTrans,\n            data,\n            color\n          }) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border rounded p-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-sm font-medium mb-2\",\n              children: earTrans\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1161,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n              width: \"100%\",\n              height: 200,\n              children: /*#__PURE__*/_jsxDEV(LineChart, {\n                data: data,\n                children: [/*#__PURE__*/_jsxDEV(XAxis, {\n                  dataKey: \"maskLevel\",\n                  label: {\n                    value: 'マスキング量 (dB)',\n                    position: 'insideBottom',\n                    offset: -5\n                  },\n                  tick: {\n                    fontSize: 12\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1164,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n                  dataKey: \"threshold\",\n                  label: {\n                    value: '聴力レベル (dB)',\n                    angle: -90,\n                    position: 'insideLeft'\n                  },\n                  tick: {\n                    fontSize: 12\n                  },\n                  domain: ['dataMin - 5', 'dataMax + 5']\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1169,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(CartesianGrid, {\n                  strokeDasharray: \"3 3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1175,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Line, {\n                  type: \"monotone\",\n                  dataKey: \"threshold\",\n                  stroke: color,\n                  strokeWidth: 2,\n                  dot: {\n                    fill: color,\n                    strokeWidth: 2,\n                    r: 4\n                  },\n                  activeDot: {\n                    r: 6\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1176,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1163,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1162,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-600 mt-2\",\n              children: [\"\\u30C7\\u30FC\\u30BF\\u6570: \", data.length, \"\\u70B9\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1186,\n              columnNumber: 19\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1160,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1158,\n          columnNumber: 13\n        }, this)]\n      }, freq, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1156,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1135,\n    columnNumber: 5\n  }, this);\n}\n\n// small UI helpers\n_s2(LogVisualizationCharts, \"L+8foqbGjSXrXUScWJWrY/t4VwU=\");\n_c3 = LogVisualizationCharts;\nfunction Control({\n  label,\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-gray-700 mb-1 text-base\",\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1203,\n      columnNumber: 7\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1202,\n    columnNumber: 5\n  }, this);\n}\n_c4 = Control;\nfunction TinyToggle({\n  active,\n  onClick,\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: onClick,\n    className: `px-3 py-2 rounded-lg border text-base ${active ? 'bg-black text-white border-black' : 'bg-white text-gray-800'}`,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1211,\n    columnNumber: 5\n  }, this);\n}\n_c5 = TinyToggle;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"LegendMark\");\n$RefreshReg$(_c2, \"AudiogramMaskingMVP\");\n$RefreshReg$(_c3, \"LogVisualizationCharts\");\n$RefreshReg$(_c4, \"Control\");\n$RefreshReg$(_c5, \"TinyToggle\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","useLayoutEffect","ResponsiveContainer","ComposedChart","XAxis","YAxis","CartesianGrid","Scatter","Line","LineChart","jsxDEV","_jsxDEV","CAL_OFFSET_DB","BC_DISABLED","Set","FREQS","X_DOMAIN","length","Y_MIN","Y_MAX","CHART_SCALE","CELL_PX","GRID_W","GRID_H","AXIS_LEFT","AXIS_RIGHT","AXIS_TOP","AXIS_BOTTOM","CHART_MARGIN","top","right","bottom","left","IA","AC","BC","AC_MAX","BC_MAX","MARK_R","MARK_STROKE","formatFreq","v","i","Math","round","String","SERIES","key","label","color","shape","mk","ear","transducer","list","map","freq","dB","so","masked","preset","name","parts","targets","flat","PRESET_A","PRESET_B","PRESET_C","PRESET_D","PRESET_E","PRESET_F","PRESET_G","PRESET_H","buildTargetsFromPreset","t","clamp","n","lo","hi","max","min","round5","seriesKey","p","isResponse","points","some","maxPresentable","transKey","f","_AC_MAX$f","_BC_MAX$f","shapeRenderer","props","cx","cy","payload","r","Arrow","children","x1","y1","x2","y2","stroke","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","fill","lbracketOffset","rbracketOffset","ltOffset","gtOffset","LegendMark","size","render","width","height","viewBox","transform","_c","AudiogramMaskingMVP","_s","_generatedProblems$cu","_generatedProblems$cu2","isAuthenticated","setIsAuthenticated","password","setPassword","TRAINING_PASSWORD","setEar","trans","setTrans","setMasked","setFreq","maskLevel","setMaskLevel","level","setLevel","setPoints","suppressLamp","setSuppressLamp","showLegend","setShowLegend","setTargets","selectedPreset","setSelectedPreset","logData","setLogData","showLogVisualization","setShowLogVisualization","showProblemGenerator","setShowProblemGenerator","generatedProblems","setGeneratedProblems","currentProblemIndex","setCurrentProblemIndex","processLogData","rawLogData","measurements","processedData","forEach","measurement","push","threshold","timestamp","Object","keys","sort","a","b","handleLogFileLoad","event","file","target","files","reader","FileReader","onload","e","jsonData","JSON","parse","result","error","console","alert","readAsText","generateRandomProblems","allPresets","problems","randomPreset","floor","random","id","question","fromCharCode","indexOf","description","loadCurrentProblem","currentProblem","nextProblem","previousProblem","containerRef","chartHostRef","overlayRef","plotCalRef","scaleY","deltaTop","chartW","chartH","host","current","ov","gridG","querySelector","getBoundingClientRect","gridRect","ovRect","_tmap$get","assert","Array","isArray","every","s","sampleTicks","from","_","tmap","Map","filter","_AC_MAX$t$freq","_BC_MAX$t$freq","base","set","k","get","Number","isFinite","getThr","yMin","yMax","gridH","mapYToDb","y","assertNear5","val","expect","abs","localMap","_AC_MAX$t$freq2","_BC_MAX$t$freq2","overMax","_getThr","earKey","_localMap$get$dB","_localMap$get","Infinity","_hears","L","maskedFlag","maskLvl","_IA$transKey","teThr","testEarHeard","nte","ia","leakedToNTE","nteBC","effectiveMask","crossHeard","warn","showAnswer","setShowAnswer","overMaskingWarning","setOverMaskingWarning","blinkOn","setBlinkOn","setInterval","clearInterval","log","window","onKeyDown","el","tag","tagName","toUpperCase","type","toLowerCase","isTypingField","isContentEditable","preventDefault","prev","idx","nextIdx","newLevel","setTimeout","addOrReplacePoint","removePointAtCurrent","addEventListener","capture","removeEventListener","freqIndex","moveFreq","dir","has","p2","atMax","heardAtMax","hearsAtLevel","p3","x","kp","others","q","handlePlotClick","clickX","clientX","clickY","clientY","yRange","yRatio","dBraw","dBclamped","clearAll","targetMap","_AC_MAX$t$freq3","_BC_MAX$t$freq3","isOverMasking","testEarThreshold","maskingLimit","_AC_MAX$f2","_BC_MAX$f2","_IA$transKey2","seriesData","m","xIdx","acLineData","out","includes","pts","answerSeriesData","_AC_MAX$t$freq4","_BC_MAX$t$freq4","isSO","yVal","answerLineData","currentTarget","find","lampOn","getActualThreshold","baseThreshold","overMasking","className","value","onChange","onKeyPress","placeholder","onClick","disabled","ref","accept","Control","TinyToggle","active","step","parseInt","title","w","style","overflow","cursor","zIndex","pointerEvents","background","onPointerUp","onPointerDown","data","margin","strokeDasharray","dataKey","domain","ticks","tickFormatter","position","offset","fontSize","tick","reversed","tickMargin","angle","dy","xAxisId","yAxisId","dot","d","startsWith","undefined","connectNulls","opacity","isAnimationActive","strokeOpacity","display","alignItems","LogVisualizationCharts","_c2","_s2","frequencies","colors","chartsForFreq","freqStr","split","earTransKey","earTrans","activeDot","_c3","_c4","_c5","$RefreshReg$"],"sources":["/Users/maedahidehiko/Documents/myAudiogram builder/src/AudiogramMaskingMVP.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef, useLayoutEffect } from \"react\";\nimport { ResponsiveContainer, ComposedChart, XAxis, YAxis, CartesianGrid, Scatter, Line, LineChart } from \"recharts\";\n\n// Audiogram-first Masking Trainer (MVP v2.4.9)\n// - 1oct/grid x 10dB ticks; 1oct == 20dB; AC O/X, BC </> []\n// - Overlay blink; legend right-side panel; masking slider in header\n// - Fix: add targetMap + getThr() → resolves \"getThr is not defined\"\n\n// --- constants ---\n// Optional click→dB calibration offset (kept 0 as per spec 1/2/3)\nconst CAL_OFFSET_DB = 0;\nconst BC_DISABLED = new Set([125, 8000]); // BCは125Hz/8000Hzは測定対象外\nconst FREQS = [125, 250, 500, 1000, 2000, 4000, 8000]; // 7 points -> 6 octaves\n// Slight domain padding to prevent edge clipping without changing visible tick positions\nconst X_DOMAIN = [0, FREQS.length - 1];\nconst Y_MIN = -10;  // dB HL (top small, bottom large)\nconst Y_MAX = 120;  // 10 dB ticks (render squares use 20 dB cells)\nconst CHART_SCALE = 1;\n// Geometry to force 1 octave (X) == 20 dB (Y)\nconst CELL_PX = 100; // px per 1 octave (== 20 dB) — larger, keeps square cells\nconst GRID_W = CELL_PX * (FREQS.length - 1); // 6 octaves\nconst GRID_H = CELL_PX * ((Y_MAX - Y_MIN) / 20); // vertical cells of 20 dB\nconst AXIS_LEFT = 64, AXIS_RIGHT = 40, AXIS_TOP = 20, AXIS_BOTTOM = 48; // increase top to avoid clipping -10 dB tick\nconst CHART_MARGIN = { top: AXIS_TOP, right: AXIS_RIGHT, bottom: AXIS_BOTTOM, left: AXIS_LEFT }; // plotting box = GRID_W x GRID_H\n\n// Interaural Attenuation (IA): AC=50 dB, BC=0 dB\nconst IA = { AC: 50, BC: 0 };\n\n// Max presentable levels (for Scale-Out logic)\nconst AC_MAX = { 125: 70, 250: 90, 500: 110, 1000: 110, 2000: 110, 4000: 110, 8000: 100 };\nconst BC_MAX = { 250: 55, 500: 65, 1000: 70, 2000: 70, 4000: 60 };\n\n// Marker size for AC/BC symbols (px). 24px target → radius 12, thicker stroke.\nconst MARK_R = 8; // radius (smaller markers)\nconst MARK_STROKE = 2;\n\n// Safe tick formatter for X axis (1 octave grid labels)\nfunction formatFreq(v) {\n  const i = Math.round(typeof v === 'number' ? v : 0);\n  return String((FREQS && FREQS[i] != null) ? FREQS[i] : \"\");\n}\n\n// Legend / rendering series\nconst SERIES = [\n  { key: \"R-AC-U\", label: \"Right AC (unmasked)\", color: \"#ef4444\", shape: \"O\" },\n  { key: \"R-AC-M\", label: \"Right AC (masked)\",   color: \"#b91c1c\", shape: \"O\" },\n  { key: \"L-AC-U\", label: \"Left  AC (unmasked)\",  color: \"#3b82f6\", shape: \"X\" },\n  { key: \"L-AC-M\", label: \"Left  AC (masked)\",    color: \"#1d4ed8\", shape: \"X\" },\n  { key: \"R-BC-U\", label: \"Right BC (unmasked)\", color: \"#ef4444\", shape: \"lt\" },\n  { key: \"R-BC-M\", label: \"Right BC (masked)\",   color: \"#b91c1c\", shape: \"lbracket\" },\n  { key: \"L-BC-U\", label: \"Left  BC (unmasked)\",  color: \"#3b82f6\", shape: \"gt\" },\n  { key: \"L-BC-M\", label: \"Left  BC (masked)\",    color: \"#1d4ed8\", shape: \"rbracket\" },\n];\n\n// --- preset helpers (compress verbose targets to keep file small) --- (compress verbose targets to keep file small) ---\nconst mk = (ear, transducer, list) =>\n  list.map(([freq, dB, so=false]) => ({ ear, transducer, masked:false, freq, dB, ...(so?{so:true}:{}) }));\nconst preset = (name, parts) => ({ name, targets: parts.flat() });\n\n// --- Preset cases (targets kept \"secret\"; used for overlay/validation only) ---\n// Each target: { ear:'R'|'L', transducer:'AC'|'BC', masked:false, freq:number, dB:number, so?:true }\nconst PRESET_A = preset('症例A', [\n  mk('R','AC', [[125,5],[250,5],[500,5],[1000,5],[2000,5],[4000,0],[8000,0]]),\n  mk('L','AC', [[125,10],[250,10],[500,5],[1000,5],[2000,5],[4000,0],[8000,-5]]),\n  mk('R','BC', [[250,5],[500,10],[1000,5],[2000,5],[4000,-5]]),\n  mk('L','BC', [[250,5],[500,5],[1000,0],[2000,5],[4000,0]])\n]);\n\nconst PRESET_B = preset('症例B', [\n  // Right AC / BC\n  mk('R','AC', [[125,10],[500,30],[1000,50],[2000,70],[4000,90],[8000,100]]),\n  mk('R','BC', [[125,10],[500,30],[1000,50],[2000,70],[4000,90],[8000,100]]),\n  // Left AC / BC\n  mk('L','AC', [[125,15],[250,15],[500,10],[1000,10],[2000,5],[4000,5],[8000,10]]),\n  mk('L','BC', [[250,15],[500,10],[1000,10],[2000,5],[4000,5]])\n]);\n\nconst PRESET_C = preset('症例C', [\n  // Right AC / BC\n  mk('R','AC', [[125,20],[250,20],[500,15],[1000,10],[2000,10],[4000,5],[8000,5]]),\n  mk('R','BC', [[250,15],[500,15],[1000,10],[2000,5],[4000,10]]),\n  // Left AC/BC (SO)\n  mk('L','AC', [[125,110,true],[250,110,true],[500,110,true],[1000,110,true],[2000,110,true],[4000,110,true],[8000,110,true]]),\n  mk('L','BC', [[250,110,true],[500,110,true],[1000,110,true],[2000,110,true],[4000,110,true]])\n]);\n\nconst PRESET_D = preset('症例D', [\n  // Right AC / BC - 高音域の聴力低下\n  mk('R','AC', [[125,5],[250,5],[500,5],[1000,10],[2000,25],[4000,45],[8000,65]]),\n  mk('R','BC', [[125,5],[250,5],[500,5],[1000,10],[2000,20],[4000,35],[8000,50]]),\n  // Left AC / BC - 低音域の聴力低下\n  mk('L','AC', [[125,25],[250,30],[500,20],[1000,10],[2000,5],[4000,5],[8000,10]]),\n  mk('L','BC', [[125,20],[250,25],[500,20],[1000,10],[2000,5],[4000,5],[8000,10]])\n]);\n\nconst PRESET_E = preset('症例E', [\n  // Right AC / BC - 混合性難聴パターン\n  mk('R','AC', [[125,15],[250,20],[500,20],[1000,30],[2000,35],[4000,35],[8000,45]]),\n  mk('R','BC', [[125,10],[250,15],[500,20],[1000,25],[2000,30],[4000,35],[8000,40]]),\n  // Left AC / BC - 感音性難聴パターン\n  mk('L','AC', [[125,40],[250,45],[500,40],[1000,55],[2000,60],[4000,60],[8000,70]]),\n  mk('L','BC', [[125,35],[250,40],[500,45],[1000,50],[2000,55],[4000,60],[8000,65]])\n]);\n\nconst PRESET_F = preset('症例F', [\n  // Right AC / BC - 感音難聴（高音漸傾型）\n  mk('R','AC', [[125,10],[250,15],[500,20],[1000,30],[2000,45],[4000,65],[8000,80]]),\n  mk('R','BC', [[125,10],[250,15],[500,20],[1000,30],[2000,45],[4000,65],[8000,80]]),\n  // Left AC / BC - 感音難聴（高音漸傾型、左右同じ）\n  mk('L','AC', [[125,10],[250,15],[500,20],[1000,30],[2000,45],[4000,65],[8000,80]]),\n  mk('L','BC', [[125,10],[250,15],[500,20],[1000,30],[2000,45],[4000,65],[8000,80]])\n]);\n\nconst PRESET_G = preset('症例G', [\n  // Right AC / BC - 伝音難聴パターン\n  mk('R','AC', [[125,35],[250,40],[500,45],[1000,50],[2000,55],[4000,60],[8000,65]]),\n  mk('R','BC', [[125,5],[250,5],[500,5],[1000,5],[2000,5],[4000,5],[8000,5]]),\n  // Left AC / BC - 混合性難聴パターン\n  mk('L','AC', [[125,25],[250,30],[500,35],[1000,40],[2000,45],[4000,50],[8000,55]]),\n  mk('L','BC', [[125,15],[250,20],[500,25],[1000,30],[2000,35],[4000,40],[8000,45]])\n]);\n\nconst PRESET_H = preset('症例H', [\n  // Right AC / BC - 感音難聴（平坦型）\n  mk('R','AC', [[125,50],[250,50],[500,50],[1000,50],[2000,50],[4000,50],[8000,50]]),\n  mk('R','BC', [[125,50],[250,50],[500,50],[1000,50],[2000,50],[4000,50],[8000,50]]),\n  // Left AC / BC - 感音難聴（平坦型、左右同じ）\n  mk('L','AC', [[125,50],[250,50],[500,50],[1000,50],[2000,50],[4000,50],[8000,50]]),\n  mk('L','BC', [[125,50],[250,50],[500,50],[1000,50],[2000,50],[4000,50],[8000,50]])\n]);\n\nfunction buildTargetsFromPreset(preset){\n  return preset.targets.map(t => ({...t}));\n}\n\n// helpers\nfunction clamp(n, lo, hi) { return Math.max(lo, Math.min(hi, n)); }\nfunction round5(n) { return Math.round(n / 5) * 5; }\nfunction seriesKey(p) { return `${p.ear}-${p.transducer}-${p.masked ? \"M\" : \"U\"}`; }\nfunction isResponse(points, t) {\n  return points.some(p => p.ear===t.ear && p.transducer===t.transducer && p.masked===t.masked && p.freq===t.freq && p.dB >= t.dB);\n}\n// PRESENTATION LIMIT (fix for ReferenceError: maxPresentable is not defined)\nfunction maxPresentable(transKey, f) {\n  return transKey === 'AC' ? (AC_MAX[f] ?? 110) : (BC_MAX[f] ?? 110);\n}\n\n// shape renderer (adds SO arrow if payload.so)\nfunction shapeRenderer(shape, color) {\n  return (props) => {\n    const { cx, cy, payload } = props;\n    const r = MARK_R;\n    const t = MARK_STROKE;\n    const so = payload && payload.so;\n    const Arrow = so ? (\n      <g>\n        <line x1={cx} y1={cy + r + 2} x2={cx} y2={cy + r + 10} stroke={color} strokeWidth={t} />\n        <line x1={cx - 4} y1={cy + r + 6} x2={cx} y2={cy + r + 10} stroke={color} strokeWidth={t} />\n        <line x1={cx + 4} y1={cy + r + 6} x2={cx} y2={cy + r + 10} stroke={color} strokeWidth={t} />\n      </g>\n    ) : null;\n\n    switch (shape) {\n      case 'O':\n        return (\n          <g>\n            <circle cx={cx} cy={cy} r={r} stroke={color} strokeWidth={t} fill=\"white\" />\n            {Arrow}\n          </g>\n        );\n      case 'X':\n        return (\n          <g stroke={color} strokeWidth={t}>\n            <line x1={cx - r} y1={cy - r} x2={cx + r} y2={cy + r} />\n            <line x1={cx - r} y1={cy + r} x2={cx + r} y2={cy - r} />\n            {Arrow}\n          </g>\n        );\n      case 'lbracket': // [ (masked BC Right) - 左にずらす\n        const lbracketOffset = -3; // 右耳BCを左に3pxずらす\n        return (\n          <g stroke={color} strokeWidth={t} fill=\"none\">\n            <line x1={cx - r + lbracketOffset} y1={cy - r} x2={cx - r + lbracketOffset} y2={cy + r} />\n            <line x1={cx - r + lbracketOffset} y1={cy - r} x2={cx - r/3 + lbracketOffset} y2={cy - r} />\n            <line x1={cx - r + lbracketOffset} y1={cy + r} x2={cx - r/3 + lbracketOffset} y2={cy + r} />\n            {Arrow}\n          </g>\n        );\n      case 'rbracket': // ] (masked BC Left) - 右にずらす\n        const rbracketOffset = 3; // 左耳BCを右に3pxずらす\n        return (\n          <g stroke={color} strokeWidth={t} fill=\"none\">\n            <line x1={cx + r + rbracketOffset} y1={cy - r} x2={cx + r + rbracketOffset} y2={cy + r} />\n            <line x1={cx + r + rbracketOffset} y1={cy - r} x2={cx + r/3 + rbracketOffset} y2={cy - r} />\n            <line x1={cx + r + rbracketOffset} y1={cy + r} x2={cx + r/3 + rbracketOffset} y2={cy + r} />\n            {Arrow}\n          </g>\n        );\n      case 'lt': // < (unmasked BC Right) - 左にずらす\n        const ltOffset = -3; // 右耳BCを左に3pxずらす\n        return (\n          <g stroke={color} strokeWidth={t} fill=\"none\">\n            <line x1={cx + r + ltOffset} y1={cy - r} x2={cx - r/3 + ltOffset} y2={cy} />\n            <line x1={cx + r + ltOffset} y1={cy + r} x2={cx - r/3 + ltOffset} y2={cy} />\n            {Arrow}\n          </g>\n        );\n      case 'gt': // > (unmasked BC Left) - 右にずらす\n        const gtOffset = 3; // 左耳BCを右に3pxずらす\n        return (\n          <g stroke={color} strokeWidth={t} fill=\"none\">\n            <line x1={cx - r + gtOffset} y1={cy - r} x2={cx + r/3 + gtOffset} y2={cy} />\n            <line x1={cx - r + gtOffset} y1={cy + r} x2={cx + r/3 + gtOffset} y2={cy} />\n            {Arrow}\n          </g>\n        );\n      default:\n        return <circle cx={cx} cy={cy} r={r} fill={color} />;\n    }\n  };\n}\n\n// Legend icon that reuses chart shapes instead of color squares\nfunction LegendMark({ shape, color }) {\n  const size = MARK_R * 2 + 8; // padding around the symbol\n  const render = shapeRenderer(shape, color);\n  return (\n    <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`} aria-hidden>\n      <g transform={`translate(${size/2}, ${size/2})`}>\n        {render({ cx: 0, cy: 0, payload: {} })}\n      </g>\n    </svg>\n  );\n}\n\nexport default function AudiogramMaskingMVP() {\n  // 講習会用パスワード保護\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [password, setPassword] = useState('');\n  const TRAINING_PASSWORD = 'audiogram2024'; // 講習会用パスワード\n\n  // Basic UI state\n  const [ear, setEar] = useState('R'); // 'R' | 'L'\n  const [trans, setTrans] = useState('AC'); // 'AC' | 'BC'\n  const [masked, setMasked] = useState(false);\n  const [freq, setFreq] = useState(1000);\n  const [maskLevel, setMaskLevel] = useState(-15); // masking amount (dB); -15 means no masking\n  const [level, setLevel] = useState(30);\n  const [points, setPoints] = useState([]);\n  const [suppressLamp, setSuppressLamp] = useState(false); // 周波数切替時に一時的にランプ消灯\n  const [showLegend, setShowLegend] = useState(true); // ← FIX: define showLegend state\n\n  // Preset targets (secret answer)\n  const [targets, setTargets] = useState([]);\n  const [selectedPreset, setSelectedPreset] = useState('A');\n\n  // Log visualization\n  const [logData, setLogData] = useState(null);\n  const [showLogVisualization, setShowLogVisualization] = useState(false);\n\n  // Problem generation\n  const [showProblemGenerator, setShowProblemGenerator] = useState(false);\n  const [generatedProblems, setGeneratedProblems] = useState([]);\n  const [currentProblemIndex, setCurrentProblemIndex] = useState(0);\n\n  // Process log data for visualization\n  const processLogData = (rawLogData) => {\n    if (!rawLogData || !rawLogData.measurements) return null;\n    \n    const measurements = rawLogData.measurements;\n    const processedData = {};\n    \n    // Group by frequency and ear/transducer combination\n    measurements.forEach(measurement => {\n      const key = `${measurement.ear}-${measurement.transducer}-${measurement.freq}`;\n      if (!processedData[key]) {\n        processedData[key] = [];\n      }\n      processedData[key].push({\n        maskLevel: measurement.maskLevel,\n        threshold: measurement.dB,\n        timestamp: measurement.timestamp,\n        masked: measurement.masked\n      });\n    });\n    \n    // Sort by mask level for each frequency group\n    Object.keys(processedData).forEach(key => {\n      processedData[key].sort((a, b) => a.maskLevel - b.maskLevel);\n    });\n    \n    return processedData;\n  };\n\n  // Load log file\n  const handleLogFileLoad = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n    \n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const jsonData = JSON.parse(e.target.result);\n        setLogData(jsonData);\n        setShowLogVisualization(true);\n      } catch (error) {\n        console.error('Error parsing log file:', error);\n        alert('ログファイルの読み込みに失敗しました。');\n      }\n    };\n    reader.readAsText(file);\n  };\n\n  // Generate random problems\n  const generateRandomProblems = () => {\n    const allPresets = [PRESET_A, PRESET_B, PRESET_C, PRESET_D, PRESET_E, PRESET_F, PRESET_G, PRESET_H];\n    const problems = [];\n    \n    for (let i = 0; i < 10; i++) {\n      const randomPreset = allPresets[Math.floor(Math.random() * allPresets.length)];\n      problems.push({\n        id: i + 1,\n        preset: randomPreset,\n        question: `症例${String.fromCharCode(65 + allPresets.indexOf(randomPreset))}の聴力検査を実施してください。`,\n        description: `${randomPreset.name}の特徴的な聴力パターンを測定し、適切なマスキングを行ってください。`\n      });\n    }\n    \n    setGeneratedProblems(problems);\n    setCurrentProblemIndex(0);\n    setShowProblemGenerator(true);\n  };\n\n  // Load current problem\n  const loadCurrentProblem = () => {\n    if (generatedProblems.length > 0 && currentProblemIndex < generatedProblems.length) {\n      const currentProblem = generatedProblems[currentProblemIndex];\n      setPoints([]);\n      setTargets(buildTargetsFromPreset(currentProblem.preset));\n    }\n  };\n\n  // Next problem\n  const nextProblem = () => {\n    if (currentProblemIndex < generatedProblems.length - 1) {\n      setCurrentProblemIndex(currentProblemIndex + 1);\n    }\n  };\n\n  // Previous problem\n  const previousProblem = () => {\n    if (currentProblemIndex > 0) {\n      setCurrentProblemIndex(currentProblemIndex - 1);\n    }\n  };\n\n  // Refs / layout\n  const containerRef = useRef(null);\n  const chartHostRef = useRef(null);\n  const overlayRef = useRef(null);\n  const plotCalRef = useRef({ scaleY: 1, deltaTop: 0 });\n  // Fixed-size chart: plotting area derived from CELL_PX and margins (no ResponsiveContainer)\n  const chartW = GRID_W + AXIS_LEFT + AXIS_RIGHT; // widened right margin to avoid 8000 label clipping\n  const chartH = GRID_H + AXIS_TOP + AXIS_BOTTOM;\n\n  // Auto-hide legend if plotting box is too small (safety)\n  useEffect(() => {\n    setShowLegend(chartH * CHART_SCALE > 220);\n  }, [chartH]);\n\n  // --- Plot calibration: measure real grid box and align overlay ---\n  useLayoutEffect(() => {\n    const host = chartHostRef.current;\n    const ov = overlayRef.current;\n    if (!host || !ov) return;\n    const gridG = host.querySelector('g.recharts-cartesian-grid');\n    if (!gridG || !gridG.getBoundingClientRect) return;\n    const gridRect = gridG.getBoundingClientRect();\n    const ovRect = ov.getBoundingClientRect();\n    const scaleY = gridRect.height / Math.max(1, ovRect.height);\n    const deltaTop = gridRect.top - ovRect.top; // 上端の差（オーバーレイ→グリッド）\n    plotCalRef.current = { scaleY, deltaTop };\n  });\n\n  // --- Dev sanity checks (non-intrusive) ---\n  useEffect(() => {\n    try {\n      console.assert(Array.isArray(FREQS) && FREQS.length === 7, 'FREQS should have 7 items');\n      console.assert(SERIES.every(s => s.key && s.color && s.shape), 'SERIES entries must have key/color/shape');\n      const sampleTicks = Array.from({length: FREQS.length}, (_,i)=> i).map(formatFreq);\n      console.assert(sampleTicks.every(t => String(t).length > 0), 'formatFreq should produce labels');\n      // quick unit-like check for getThr mapping using PRESET_A\n      const tmap = new Map();\n      PRESET_A.targets.filter(t=>t.masked===false).forEach(t=>{\n        const key = `${t.ear}|${t.transducer}|${t.freq}`;\n        const base = t.so ? ((t.transducer==='AC'?(AC_MAX[t.freq]??110):(BC_MAX[t.freq]??110))+50) : t.dB;\n        tmap.set(key, {dB: base});\n      });\n      const k = 'R|AC|1000';\n      console.assert(tmap.get(k)?.dB === 5, 'getThr baseline sanity (R AC 1kHz should be 5 dB)');\n      // helpers\n      console.assert(round5(52) === 50 && round5(53) === 55, 'round5 should snap to nearest 5');\n      console.assert(maxPresentable('AC', 1000) === 110, 'AC max @1k should be 110');\n      // ensure getThr (component-scope) resolves with targetMap in place\n      console.assert(Number.isFinite(getThr('R','AC',1000)), 'getThr should resolve for R AC 1k');\n\n      // === Added self-tests per spec (1) 5dB丸め, (2) -10/120クランプ, (3) 0/50/100整合 ===\n      // Pure mapping test with synthetic geometry\n      const yMin=-10, yMax=120, gridH= (yMax - yMin); // 1px == 1dB for synthetic\n      const mapYToDb = (y)=> yMin + (Math.max(0, Math.min(gridH, y)) / gridH) * (yMax - yMin);\n      const assertNear5 = (val, expect)=> console.assert(Math.abs(round5(val) - expect) <= 0, `round5(${val}) ~= ${expect}`);\n      assertNear5(mapYToDb( (0) ), -10);\n      assertNear5(mapYToDb( gridH*0.5 ), 55); // 中央\n      assertNear5(mapYToDb( gridH ), 120);\n      // clamp extremes\n      console.assert(Math.min(yMax, Math.max(yMin, -15)) === -10, 'clamp top to -10dB');\n      console.assert(Math.min(yMax, Math.max(yMin, 130)) === 120, 'clamp bottom to 120dB');\n\n      // showLegend presence\n      console.assert(typeof showLegend === 'boolean', 'showLegend should be boolean');\n\n      // masking logic quick checks\n      const targets = PRESET_A.targets;\n      const localMap = new Map();\n      targets.filter(t=>t.masked===false).forEach(t=>{\n        const overMax = (t.transducer==='AC' ? (AC_MAX[t.freq] ?? 110) : (BC_MAX[t.freq] ?? 110)) + 50;\n        localMap.set(`${t.ear}|${t.transducer}|${t.freq}`, { dB: t.so ? overMax : t.dB });\n      });\n      const _getThr = (earKey, transKey, f)=> (localMap.get(`${earKey}|${transKey}|${f}`)?.dB ?? Infinity);\n      const _hears = (earKey, transKey, f, L, maskedFlag, maskLvl)=>{\n        const teThr = _getThr(earKey, transKey, f);\n        const testEarHeard = L >= teThr;\n        const nte = earKey === 'R' ? 'L' : 'R';\n        const ia = IA[transKey] ?? 0;\n        const leakedToNTE = L - ia;\n        const nteBC = _getThr(nte, 'BC', f);\n        const effectiveMask = (maskedFlag && maskLvl > nteBC) ? maskLvl : nteBC;\n        const crossHeard = leakedToNTE >= effectiveMask;\n        return testEarHeard || crossHeard;\n      };\n      console.assert(_hears('R','AC',1000,10,false,-15) === true, 'test-ear hears >= thr');\n      console.assert(_hears('R','AC',2000,70,true,80) === true, 'effective masking keeps true via test-ear');\n    } catch (e) {\n      console.warn('Sanity check failed:', e);\n    }\n  }, [showLegend]);\n\n  // Overlay answer (blink)\n  const [showAnswer, setShowAnswer] = useState(false);\n  const [overMaskingWarning, setOverMaskingWarning] = useState(true); // オーバーマスキング警告のON/OFF\n  const [blinkOn, setBlinkOn] = useState(true);\n\n  useEffect(() => {\n    if (!showAnswer) return;\n    const id = setInterval(() => setBlinkOn(b => !b), 700);\n    return () => clearInterval(id);\n  }, [showAnswer]);\n\n  // Debug: log showAnswer state changes\n  useEffect(() => {\n    console.log('showAnswer changed:', showAnswer);\n  }, [showAnswer]);\n\n  // Keyboard: Arrow keys for navigation and level control\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const onKeyDown = (e) => {\n      const el = e.target;\n      const tag = (el && el.tagName) ? el.tagName.toUpperCase() : '';\n      const type = (el && el.type) ? String(el.type).toLowerCase() : '';\n      const isTypingField = (tag === 'INPUT' && (type === 'text' || type === 'number' || type === 'search' || type === 'email' || type === 'password'))\n                           || tag === 'TEXTAREA'\n                           || (el && el.isContentEditable === true);\n      if (isTypingField) return;\n\n      // 周波数変更（左右キー）\n      if (e.key === 'ArrowRight') {\n        e.preventDefault();\n        console.log('右キー押下');\n        setFreq((prev) => {\n          const idx = Math.max(0, FREQS.indexOf(prev));\n          const nextIdx = Math.min(FREQS.length - 1, idx + 1);\n          return FREQS[nextIdx];\n        });\n      }\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        console.log('左キー押下');\n        setFreq((prev) => {\n          const idx = Math.max(0, FREQS.indexOf(prev));\n          const nextIdx = Math.max(0, idx - 1);\n          return FREQS[nextIdx];\n        });\n      }\n\n      // レベル調整（上下キー）- 上下を逆にして、自動打点\n      if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        console.log('上キー押下');\n        setLevel((prev) => {\n          const newLevel = Math.min(Y_MAX, prev - 5); // 上キーで-5dB\n          setSuppressLamp(false);\n          // 自動で打点追加\n          setTimeout(() => {\n            addOrReplacePoint({ ear, transducer: trans, masked, freq, dB: round5(newLevel) });\n          }, 50);\n          return newLevel;\n        });\n      }\n      if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        console.log('下キー押下');\n        setLevel((prev) => {\n          const newLevel = Math.max(Y_MIN, prev + 5); // 下キーで+5dB\n          setSuppressLamp(false);\n          // 自動で打点追加\n          setTimeout(() => {\n            addOrReplacePoint({ ear, transducer: trans, masked, freq, dB: round5(newLevel) });\n          }, 50);\n          return newLevel;\n        });\n      }\n\n      // Deleteキーで現在の打点削除\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        e.preventDefault();\n        removePointAtCurrent();\n      }\n    };\n    window.addEventListener('keydown', onKeyDown, { capture: true });\n    return () => {\n      window.removeEventListener('keydown', onKeyDown, { capture: true });\n    };\n  }, [ear, trans, masked, freq, level]);\n\n  // 周波数が変わったら一度ランプを消灯\n  useEffect(() => { setSuppressLamp(true); }, [freq]);\n\n  const freqIndex = useMemo(() => Math.max(0, FREQS.indexOf(freq)), [freq]);\n  function moveFreq(dir /* -1 | 1 */) {\n    let idx = clamp(freqIndex + dir, 0, FREQS.length - 1);\n    // BC時は125/8000Hzをスキップ\n    if (trans === 'BC') {\n      while (BC_DISABLED.has(FREQS[idx])) {\n        idx = clamp(idx + dir, 0, FREQS.length - 1);\n        if (idx === 0 || idx === FREQS.length - 1) break;\n      }\n    }\n    setFreq(FREQS[idx]);\n  }\n\n  // clicking on chart -> add/replace point for current ear/trans/masked+freq\n  function addOrReplacePoint(p) {\n    if (p.transducer === 'BC' && BC_DISABLED.has(p.freq)) {\n      setSuppressLamp(true);\n      return;\n    }\n    const p2 = { ...p, masked: p.masked };\n    const max = maxPresentable(p2.transducer, p2.freq);\n    const atMax = p2.dB >= max;\n    const heardAtMax = hearsAtLevel(p2.ear, p2.transducer, p2.freq, max);\n    const so = atMax && !heardAtMax;\n    const p3 = { ...p2, dB: atMax ? max : p2.dB, ...(so ? { so: true } : {}) };\n\n    setPoints(prev => {\n      const k = (x) => `${x.ear}|${x.transducer}|${x.masked ? 'M' : 'U'}|${x.freq}`;\n      const kp = k(p3);\n      const others = prev.filter(q => k(q) !== kp);\n      return [...others, p3].sort((a,b)=> (a.freq-b.freq) || (a.dB-b.dB));\n    });\n    setSuppressLamp(false);\n  }\n\n  // Precise hit: map overlay click to real grid using measured scale/offset\n  function handlePlotClick(e){\n    if (trans === 'BC' && BC_DISABLED.has(freq)) { setSuppressLamp(true); return; }\n    const ov = overlayRef.current;\n    if (!ov) return;\n    const ovRect = ov.getBoundingClientRect();\n    \n    // クリック位置をオーバーレイ内の相対座標に変換\n    const clickX = e.clientX - ovRect.left;\n    const clickY = e.clientY - ovRect.top;\n    \n    // Y軸の範囲を計算（オーディオグラムは上から下に-10dBから120dB）\n    const yRange = Y_MAX - Y_MIN; // 130dB\n    const yRatio = clickY / ovRect.height; // 0から1の比率\n    \n    // RechartsのY軸はreversed=trueなので、座標変換を修正\n    // 上（yRatio=0）が120dB、下（yRatio=1）が-10dB\n    let dBraw = Y_MIN + (yRatio * yRange);\n    dBraw += CAL_OFFSET_DB; // optional small offset (kept 0 by default)\n    const dBclamped = clamp(round5(dBraw), Y_MIN, Y_MAX);\n\n    const max = maxPresentable(trans, freq);\n    const atMax = dBclamped >= max;\n    const heardAtMax = hearsAtLevel(ear, trans, freq, max);\n    const so = atMax && !heardAtMax;\n\n    const p = { ear, transducer: trans, masked, freq, dB: atMax ? max : dBclamped, ...(so ? { so: true } : {}) };\n    addOrReplacePoint(p);\n    setLevel(p.dB);\n    setSuppressLamp(false);\n  }\n\n  function removePointAtCurrent() {\n    setPoints(prev => prev.filter(q => !(\n      q.ear===ear && q.transducer===trans && q.freq===freq && q.masked===masked\n    )));\n  }\n  function clearAll() { setPoints([]); }\n\n  // ---- Target lookup for cross-hearing & lamp logic ----\n  const targetMap = useMemo(() => {\n    const map = new Map();\n    (targets||[]).forEach(t => {\n      if (!t || t.masked !== false || typeof t.freq !== 'number') return;\n      const overMax = (t.transducer==='AC' ? (AC_MAX[t.freq] ?? 110) : (BC_MAX[t.freq] ?? 110)) + 50;\n      const dB = t.so ? overMax : t.dB;\n      map.set(`${t.ear}|${t.transducer}|${t.freq}`, { dB });\n    });\n    return map;\n  }, [targets]);\n\n  // オーバーマスキング検出\n  const isOverMasking = useMemo(() => {\n    if (!masked || !overMaskingWarning) return false;\n    \n    const testEarThreshold = getThr(ear, trans, freq);\n    if (testEarThreshold === Infinity) {\n      return false;\n    }\n    \n    // マスキングの上限 = 測定耳閾値 + 50dB\n    const maskingLimit = testEarThreshold + 50;\n    \n    // マスキングレベルが上限を超えている場合\n    return maskLevel > maskingLimit;\n  }, [masked, maskLevel, ear, trans, freq, overMaskingWarning, targetMap]);\n\n  function getThr(earKey, transKey, f) {\n    const key = `${earKey}|${transKey}|${f}`;\n    const v = targetMap.get(key);\n    \n    \n    if (v && typeof v.dB === 'number') {\n      // SO（Scale-Out）の場合は最大値+50dBを返す\n      if (v.dB >= 110) {\n        return (transKey === 'AC' ? (AC_MAX[f] ?? 110) : (BC_MAX[f] ?? 110)) + 50;\n      }\n      return v.dB;\n    }\n    return Infinity; // missing → treat as no response\n  }\n\n  function hearsAtLevel(earKey, transKey, f, L) {\n    const teThr = getThr(earKey, transKey, f);\n    const testEarHeard = L >= teThr;\n    const nte = earKey === 'R' ? 'L' : 'R';\n    const ia = IA[transKey] ?? 0;\n    const leakedToNTE = L - ia;\n    \n    // マスキングの基本原理：\n    // AC測定時：非測定耳のBC閾値と比較\n    // BC測定時：非測定耳のBC閾値と比較\n    const nteBC = getThr(nte, 'BC', f);\n    \n    // マスキングの計算\n    let effectiveMask = nteBC;\n    if (masked && maskLevel > nteBC) {\n      // マスキングレベルが非測定耳BC閾値より高い場合\n      effectiveMask = maskLevel;\n    }\n    \n    const crossHeard = leakedToNTE >= effectiveMask;\n    \n    return testEarHeard || crossHeard;\n  }\n\n  // series data (user)\n  const seriesData = useMemo(() => {\n    const m = {}; SERIES.forEach(s => m[s.key] = []);\n    points.forEach(p => {\n      const key = seriesKey(p);\n      if (!m[key]) m[key] = [];\n      const i = Math.max(0, FREQS.indexOf(p.freq));\n      const xIdx = i;\n      m[key].push({ x: xIdx, idx: i, y: p.dB, ...(p.so ? { so: true } : {}) });\n    });\n    return m;\n  }, [points]);\n\n  // AC lines (connect) — break at Scale-Out and at gaps\n  const acLineData = useMemo(() => {\n    const out = {};\n    SERIES.filter(s => s.key.includes('-AC-')).forEach(s => {\n      out[s.key] = FREQS.map((_, i) => ({ x: i, y: null }));\n      const pts = seriesData[s.key] || [];\n      pts.forEach(p => {\n        const i = p.x;\n        if (!p || typeof i !== 'number') return;\n        out[s.key][i] = p.so ? { x: i, y: null } : { x: i, y: p.y };\n      });\n    });\n    return out;\n  }, [seriesData]);\n\n  // Build answer overlay series from loaded targets (markers)\n  const answerSeriesData = useMemo(() => {\n    const m = {}; SERIES.forEach(s => m[s.key] = []);\n    (targets||[]).forEach(t => {\n      if (t.transducer === 'BC' && BC_DISABLED.has(t.freq)) return;\n      const i = Math.max(0, FREQS.indexOf(t.freq));\n      const xIdx = i;\n      const isSO = !!t.so;\n      const yVal = isSO\n        ? (t.transducer === 'AC' ? (AC_MAX[t.freq] ?? 110) : (BC_MAX[t.freq] ?? 110))\n        : t.dB;\n      // BCの場合は常にmaskedのキーを使用\n      const key = t.transducer === 'BC' \n        ? `${t.ear}-${t.transducer}-M` \n        : `${t.ear}-${t.transducer}-${t.masked ? 'M' : 'U'}`;\n      m[key] = m[key] || [];\n      m[key].push({ x: xIdx, y: yVal, ...(isSO ? { so:true } : {}) });\n    });\n    console.log('answerSeriesData generated:', m);\n    return m;\n  }, [targets]);\n\n  // Answer AC lines: break at SO and at gaps by inserting null placeholders\n  const answerLineData = useMemo(() => {\n    const out = {};\n    SERIES.filter(s => s.key.includes('-AC-')).forEach(s => {\n      out[s.key] = FREQS.map((_, i) => ({ x: i, y: null }));\n      const pts = (answerSeriesData[s.key] || []);\n      pts.forEach(p => {\n        const i = p.x;\n        if (!p || typeof i !== 'number') return;\n        out[s.key][i] = p.so ? { x: i, y: null } : { x: i, y: p.y };\n      });\n    });\n    return out;\n  }, [answerSeriesData]);\n\n  // Response lamp (current condition vs target >= OR cross-hearing)\n  const currentTarget = useMemo(() => (targets||[]).find(x => x.ear===ear && x.transducer===trans && x.masked===false && x.freq===freq), [targets, ear, trans, freq]);\n  const lampOn = useMemo(() => {\n    if (!currentTarget) return false;\n    if (suppressLamp) return false; // 抑制中は消灯\n    const L = round5(level);\n    \n    // クロスヒアリングを考慮した応答判定\n    return hearsAtLevel(ear, trans, freq, L);\n  }, [currentTarget, level, ear, trans, freq, masked, maskLevel, targetMap, suppressLamp]);\n\n  // オーバーマスキングを考慮した実際の閾値を取得\n  function getActualThreshold(earKey, transKey, f) {\n    const baseThreshold = getThr(earKey, transKey, f);\n    \n    if (masked && transKey === 'BC') {\n      // BC測定時のオーバーマスキング計算\n      // マスキングの上限 = 測定耳BC閾値 + 50dB\n      const maskingLimit = baseThreshold + 50;\n      \n      if (maskLevel > maskingLimit) {\n        // オーバーマスキング発生\n        const overMasking = maskLevel - maskingLimit;\n        return baseThreshold + overMasking;\n      }\n    }\n    \n    return baseThreshold;\n  }\n\n  // パスワード認証画面\n  if (!isAuthenticated) {\n    return (\n      <div className=\"w-full min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full mx-4\">\n          <div className=\"text-center mb-6\">\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">オーディオグラム講習会</h1>\n            <p className=\"text-gray-600\">参加用パスワードを入力してください</p>\n          </div>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">パスワード</label>\n              <input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                onKeyPress={(e) => e.key === 'Enter' && password === TRAINING_PASSWORD && setIsAuthenticated(true)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"講習会パスワード\"\n              />\n            </div>\n            <button\n              onClick={() => password === TRAINING_PASSWORD && setIsAuthenticated(true)}\n              disabled={password !== TRAINING_PASSWORD}\n              className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed\"\n            >\n              参加する\n            </button>\n          </div>\n          <div className=\"mt-6 text-center text-sm text-gray-500\">\n            パスワード: audiogram2024\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"w-full min-h-screen p-6 md:p-10 bg-gray-50 text-gray-900\" ref={containerRef}>\n      <div className=\"max-w-7xl mx-auto grid gap-6\">\n        <header className=\"flex flex-col md:flex-row md:items-end md:justify-between gap-3\">\n          <div>\n            <h1 className=\"text-2xl md:text-3xl font-bold\">Simple Audiogram builder (Masking simulator)</h1>\n            <p className=\"text-sm text-gray-600 mt-1\">講習会参加中 - 講師の指示に従って操作してください</p>\n          </div>\n          <button\n            onClick={() => setIsAuthenticated(false)}\n            className=\"px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\n          >\n            退出\n          </button>\n        </header>\n\n        {/* 講習会用説明 */}\n        <div className=\"bg-blue-50 border border-blue-200 rounded-2xl p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"text-blue-600 text-xl\">📚</div>\n            <div>\n              <div className=\"font-semibold text-blue-800\">講習会参加者の方へ</div>\n              <div className=\"text-sm text-blue-700 mt-1\">\n                • 講師の指示に従って症例を選択してください<br/>\n                • 各自で操作しながら学習を進めてください<br/>\n                • 質問がある場合はチャットでお聞きください<br/>\n                • 正答表示は講師の指示があるまで待ってください\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* キーボード操作説明 */}\n        <div className=\"bg-green-50 border border-green-200 rounded-2xl p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"text-green-600 text-xl\">⌨️</div>\n            <div>\n              <div className=\"font-semibold text-green-800\">キーボード操作</div>\n              <div className=\"text-sm text-green-700 mt-1\">\n                <strong>カーソルキー:</strong> ←→周波数変更 | ↑-5dB調整(自動打点) | ↓+5dB調整(自動打点)<br/>\n                <strong>削除:</strong> DeleteキーまたはBackspaceキーで現在の打点削除<br/>\n                <strong>マウス:</strong> チャートクリックでも打点可能\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Preset loader (secret) */}\n        <div className=\"bg-white rounded-2xl shadow p-4\">\n          <div className=\"flex flex-wrap items-center gap-3\">\n            <span className=\"text-sm text-gray-600\">症例プリセット</span>\n            <select className=\"border rounded-xl px-2 py-1 text-sm\" value={selectedPreset} onChange={(e)=> setSelectedPreset(e.target.value)}>\n              <option value=\"A\">症例A</option>\n              <option value=\"B\">症例B</option>\n              <option value=\"C\">症例C</option>\n              <option value=\"D\">症例D</option>\n              <option value=\"E\">症例E</option>\n              <option value=\"F\">症例F</option>\n              <option value=\"G\">症例G</option>\n              <option value=\"H\">症例H</option>\n            </select>\n            <button className=\"px-3 py-2 rounded-xl bg-teal-600 text-white text-sm\" onClick={()=>{\n              const p = selectedPreset==='A' ? PRESET_A : selectedPreset==='B' ? PRESET_B : selectedPreset==='C' ? PRESET_C : selectedPreset==='D' ? PRESET_D : selectedPreset==='E' ? PRESET_E : selectedPreset==='F' ? PRESET_F : selectedPreset==='G' ? PRESET_G : PRESET_H;\n              setPoints([]);\n              setTargets(buildTargetsFromPreset(p));\n            }}>LOAD</button>\n            <span className=\"text-xs text-gray-400\">※ LOADでプロットは自動クリア。正答は画面に表示しません（照合/オーバーレイ用）。</span>\n          </div>\n        </div>\n\n        {/* Problem Generator */}\n        <div className=\"bg-white rounded-2xl shadow p-4\">\n          <div className=\"flex flex-wrap items-center gap-3\">\n            <span className=\"text-sm text-gray-600\">問題生成</span>\n            <button \n              className=\"px-3 py-2 rounded-xl bg-green-600 text-white text-sm\"\n              onClick={generateRandomProblems}\n            >\n              ランダム問題生成\n            </button>\n            <button \n              className=\"px-3 py-2 rounded-xl bg-blue-600 text-white text-sm\"\n              onClick={() => setShowProblemGenerator(!showProblemGenerator)}\n              disabled={generatedProblems.length === 0}\n            >\n              {showProblemGenerator ? '問題非表示' : '問題表示'}\n            </button>\n            <span className=\"text-xs text-gray-400\">※ ランダムに症例を選択して問題を生成</span>\n          </div>\n        </div>\n\n        {/* Log Visualization */}\n        <div className=\"bg-white rounded-2xl shadow p-4\">\n          <div className=\"flex flex-wrap items-center gap-3\">\n            <span className=\"text-sm text-gray-600\">ログ視覚化</span>\n            <input\n              type=\"file\"\n              accept=\".json\"\n              onChange={handleLogFileLoad}\n              className=\"text-sm\"\n            />\n            <button \n              className=\"px-3 py-2 rounded-xl bg-purple-600 text-white text-sm\"\n              onClick={() => setShowLogVisualization(!showLogVisualization)}\n              disabled={!logData}\n            >\n              {showLogVisualization ? 'グラフ非表示' : 'グラフ表示'}\n            </button>\n            <span className=\"text-xs text-gray-400\">※ JSONログファイルを読み込んでマスキング量と聴力レベルの関係を視覚化</span>\n          </div>\n        </div>\n\n        {/* Controls */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"grid md:grid-cols-6 gap-4 text-sm\">\n            <Control label=\"Ear\">\n              <div className=\"flex gap-2\">\n                <button onClick={() => { setEar('R'); setFreq(1000); setSuppressLamp(true); }} className={`px-3 py-2 rounded-lg border text-base ${ear==='R' ? 'bg-red-600 text-white border-red-600' : 'bg-white text-red-600 border-red-600'}`}>Right</button>\n                <button onClick={() => { setEar('L'); setFreq(1000); setSuppressLamp(true); }} className={`px-3 py-2 rounded-lg border text-base ${ear==='L' ? 'bg-blue-600 text-white border-blue-600' : 'bg-white text-blue-600 border-blue-600'}`}>Left</button>\n              </div>\n            </Control>\n            <Control label=\"Transducer\">\n              <div className=\"flex gap-2\">\n                <TinyToggle active={trans==='AC'} onClick={() => { setTrans('AC'); setFreq(1000); setSuppressLamp(true); }}>AC</TinyToggle>\n                <TinyToggle active={trans==='BC'} onClick={() => { setTrans('BC'); setFreq(1000); setSuppressLamp(true); }}>BC</TinyToggle>\n              </div>\n            </Control>\n            <Control label=\"Frequency\">\n              <div className=\"flex items-center gap-2\">\n                <button onClick={() => moveFreq(-1)} className=\"px-2 py-1 rounded-lg border\">◀</button>\n                <div className=\"font-mono w-24 text-center\">{freq} Hz</div>\n                <button onClick={() => moveFreq(1)} className=\"px-2 py-1 rounded-lg border\">▶</button>\n              </div>\n            </Control>\n            <Control label=\"Level (dB HL)\">\n              <div className=\"flex items-center gap-3\">\n                <input type=\"range\" min={Y_MIN} max={Y_MAX} step={5} value={level} onChange={e => { setLevel(parseInt(e.target.value)); setSuppressLamp(false); }} className=\"w-full\" />\n                <div className=\"font-mono w-16 text-right\">{level}</div>\n              </div>\n            </Control>\n            <Control label=\"打点\">\n              <div className=\"flex gap-2\">\n                <button onClick={() => addOrReplacePoint({ ear, transducer: trans, masked, freq, dB: round5(level) })} className=\"px-3 py-2 rounded-xl bg-indigo-600 text-white\">追加/更新</button>\n                <button onClick={removePointAtCurrent} className=\"px-3 py-2 rounded-xl bg-white border\">削除</button>\n                <button onClick={clearAll} className=\"px-3 py-2 rounded-xl bg-white border\">全クリア</button>\n              </div>\n            </Control>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">\n            ※ チャートをクリックしても打点できます（現在選択中のEar/Transducer/Masking・周波数列に対して）。<br/>\n            ※ キーボード操作: ←→周波数変更 | ↑-5dB調整(自動打点) | ↓+5dB調整(自動打点) | Delete打点削除\n          </p>\n        </div>\n\n        {/* オーバーマスキング警告 */}\n        {isOverMasking && (\n          <div className=\"bg-red-50 border border-red-200 rounded-2xl p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"text-red-600 text-xl\">⚠️</div>\n              <div>\n                <div className=\"font-semibold text-red-800\">オーバーマスキングの可能性あり！！</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Audiogram */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"flex items-center gap-3 mb-2\">\n            <h2 className=\"text-lg font-semibold\">Audiogram</h2>\n            <div className={`flex items-center gap-2 px-2 py-1 rounded-full border ${lampOn ? 'bg-orange-50 border-orange-300' : 'bg-white border-gray-300'}`}>\n              <div className={`w-3.5 h-3.5 rounded-full ${lampOn ? 'bg-orange-500' : 'bg-gray-300'}`} />\n              <span className=\"text-xs\">応答ランプ</span>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-xs text-gray-600\">Masking (NTE: {ear === 'R' ? 'L' : 'R'})</span>\n              <div className=\"flex items-center gap-2\">\n                <TinyToggle active={!masked} onClick={() => { setMasked(false); setMaskLevel(-15); }}>Unmasked</TinyToggle>\n                <TinyToggle active={masked} onClick={() => { setMasked(true); if (maskLevel < 0) setMaskLevel(0); }}>Masked</TinyToggle>\n              </div>\n              <div className=\"flex items-center gap-2 min-w-[180px]\">\n                <input type=\"range\" min={-15} max={110} step={5} value={maskLevel} onChange={e => setMaskLevel(parseInt(e.target.value))} className=\"w-40\" />\n                <div className=\"w-16 text-right text-xs font-mono\">{maskLevel} dB</div>\n              </div>\n              <button onClick={() => setShowAnswer(a => !a)} className={`px-2 py-1 rounded-lg border text-xs ${showAnswer ? 'bg-emerald-600 text-white border-emerald-600' : 'bg-white text-gray-800'}`} title=\"正答（オーバーレイ）を表示/非表示\">\n                {showAnswer ? '正答表示: ON' : '正答表示: OFF'}\n              </button>\n              <button onClick={() => setOverMaskingWarning(w => !w)} className={`px-2 py-1 rounded-lg border text-xs ${overMaskingWarning ? 'bg-yellow-600 text-white border-yellow-600' : 'bg-white text-gray-800'}`} title=\"オーバーマスキング警告のON/OFF\">\n                {overMaskingWarning ? '警告: ON' : '警告: OFF'}\n              </button>\n            </div>\n          </div>\n\n          <div className=\"flex items-stretch gap-0 items-start\">\n            <div ref={chartHostRef} className=\"relative chart-host\" style={{ width: chartW, height: chartH, overflow: 'visible' }}>\n              <div\n                ref={overlayRef}\n                className=\"absolute\"\n                style={{ left: CHART_MARGIN.left, top: CHART_MARGIN.top, width: GRID_W, height: GRID_H, cursor: 'crosshair', zIndex: 10, pointerEvents: 'auto', background: 'transparent' }}\n                onPointerUp={handlePlotClick}\n                onPointerDown={(e)=>e.preventDefault()}\n              />\n              <ComposedChart width={chartW} height={chartH} data={[]} margin={CHART_MARGIN}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis type=\"number\" dataKey=\"x\" domain={X_DOMAIN} ticks={Array.from({ length: FREQS.length }, (_, i) => i)} tickFormatter={formatFreq} label={{ value: 'Frequency (Hz) - 1 octave/grid', position: 'bottom', offset: 6, style: { fontSize: 18 } }} tick={{ fontSize: 18 }} />\n                  <YAxis type=\"number\" dataKey=\"y\" domain={[Y_MIN, Y_MAX]} ticks={Array.from({ length: (Y_MAX - Y_MIN) / 10 + 1 }, (_, i) => Y_MIN + i * 10)} reversed={true} tickMargin={6} label={{ value: 'Hearing Level (dB HL) - 10 dB/grid', angle: -90, position: 'left', offset: 0, dy: -100, style: { fontSize: 18 } }} tick={{ fontSize: 18 }} />\n                  <Line data={[{ x: 0, y: 0 }, { x: FREQS.length - 1, y: 0 }]} dataKey=\"y\" xAxisId={0} yAxisId={0} type=\"monotone\" dot={false} stroke=\"#94a3b8\" strokeWidth={2} />\n\n                  {SERIES.map(s => (\n                    <Scatter key={s.key} name={s.label} data={(seriesData[s.key] || []).map(d => ({ x: d.x, y: d.y, ...(d.so ? { so: true } : {}) }))} fill={s.color} shape={shapeRenderer(s.shape, s.color)} />\n                  ))}\n\n                  {SERIES.filter(s => s.key.includes('-AC-')).map(s => (\n                    <Line key={`line-${s.key}`} data={acLineData[s.key] || []} dataKey=\"y\" stroke={s.color} strokeWidth={2} dot={false} strokeDasharray={s.key.startsWith('L-') ? '6 4' : undefined} type=\"linear\" connectNulls={false} />\n                  ))}\n\n                  {showAnswer && SERIES.map(s => (\n                    <Scatter key={`ans-${s.key}`} name={`${s.label} (answer)`} data={answerSeriesData[s.key] || []} fill=\"#10b981\" shape={(props) => (<g style={{ opacity: blinkOn ? 1 : 0 }}>{shapeRenderer(s.shape, '#10b981')(props)}</g>)} isAnimationActive={false} />\n                  ))}\n                  {showAnswer && SERIES.filter(s => s.key.includes('-AC-')).map(s => (\n                    <Line key={`ans-line-${s.key}`} data={answerLineData[s.key] || []} dataKey=\"y\" stroke=\"#10b981\" strokeOpacity={0.35} isAnimationActive={false} strokeWidth={2} dot={false} strokeDasharray={'4 6'} type=\"linear\" connectNulls={false} />\n                  ))}\n                </ComposedChart>\n            </div>\n            {showLegend && (\n              <div className=\"shrink-0 pl-2\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                <ul className=\"space-y-0.5 text-[16px] leading-tight pr-1\">\n                  {SERIES.map(s => (\n                    <li key={s.key} className=\"flex items-center gap-2\">\n                      <LegendMark shape={s.shape} color={s.color} />\n                      <span>{s.label}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Problem Display */}\n        {showProblemGenerator && generatedProblems.length > 0 && (\n          <div className=\"bg-white rounded-2xl shadow p-5\">\n            <h2 className=\"text-lg font-semibold mb-4\">問題 {currentProblemIndex + 1} / {generatedProblems.length}</h2>\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\n              <h3 className=\"font-semibold text-blue-800 mb-2\">{generatedProblems[currentProblemIndex]?.question}</h3>\n              <p className=\"text-blue-700 text-sm\">{generatedProblems[currentProblemIndex]?.description}</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <button \n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n                onClick={loadCurrentProblem}\n              >\n                この問題を開始\n              </button>\n              <button \n                className=\"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700\"\n                onClick={previousProblem}\n                disabled={currentProblemIndex === 0}\n              >\n                前の問題\n              </button>\n              <button \n                className=\"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700\"\n                onClick={nextProblem}\n                disabled={currentProblemIndex === generatedProblems.length - 1}\n              >\n                次の問題\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Log Visualization Charts - Only show when explicitly requested */}\n        {showLogVisualization && logData && (\n          <div className=\"bg-white rounded-2xl shadow p-5\">\n            <h2 className=\"text-lg font-semibold mb-4\">マスキング量と聴力レベルの関係</h2>\n            <LogVisualizationCharts logData={logData} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Log Visualization Component\nfunction LogVisualizationCharts({ logData }) {\n  const processedData = useMemo(() => {\n    if (!logData || !logData.measurements) return {};\n    \n    const measurements = logData.measurements;\n    const processedData = {};\n    \n    // Group by frequency and ear/transducer combination\n    measurements.forEach(measurement => {\n      const key = `${measurement.ear}-${measurement.transducer}-${measurement.freq}`;\n      if (!processedData[key]) {\n        processedData[key] = [];\n      }\n      processedData[key].push({\n        maskLevel: measurement.maskLevel,\n        threshold: measurement.dB,\n        timestamp: measurement.timestamp,\n        masked: measurement.masked\n      });\n    });\n    \n    // Sort by mask level for each frequency group\n    Object.keys(processedData).forEach(key => {\n      processedData[key].sort((a, b) => a.maskLevel - b.maskLevel);\n    });\n    \n    return processedData;\n  }, [logData]);\n\n  const frequencies = [125, 250, 500, 1000, 2000, 4000, 8000];\n  const colors = {\n    'R-AC': '#ef4444',\n    'L-AC': '#3b82f6',\n    'R-BC': '#f59e0b',\n    'L-BC': '#10b981'\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {frequencies.map(freq => {\n        const chartsForFreq = [];\n        \n        // Find all ear-transducer combinations for this frequency\n        Object.keys(processedData).forEach(key => {\n          const [ear, transducer, freqStr] = key.split('-');\n          if (parseInt(freqStr) === freq && processedData[key].length > 0) {\n            const earTransKey = `${ear}-${transducer}`;\n            chartsForFreq.push({\n              key: key,\n              earTrans: earTransKey,\n              data: processedData[key],\n              color: colors[earTransKey] || '#6b7280'\n            });\n          }\n        });\n\n        if (chartsForFreq.length === 0) return null;\n\n        return (\n          <div key={freq} className=\"border rounded-lg p-4\">\n            <h3 className=\"text-md font-semibold mb-3\">{freq} Hz</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              {chartsForFreq.map(({ key, earTrans, data, color }) => (\n                <div key={key} className=\"border rounded p-3\">\n                  <h4 className=\"text-sm font-medium mb-2\">{earTrans}</h4>\n                  <ResponsiveContainer width=\"100%\" height={200}>\n                    <LineChart data={data}>\n                      <XAxis \n                        dataKey=\"maskLevel\" \n                        label={{ value: 'マスキング量 (dB)', position: 'insideBottom', offset: -5 }}\n                        tick={{ fontSize: 12 }}\n                      />\n                      <YAxis \n                        dataKey=\"threshold\"\n                        label={{ value: '聴力レベル (dB)', angle: -90, position: 'insideLeft' }}\n                        tick={{ fontSize: 12 }}\n                        domain={['dataMin - 5', 'dataMax + 5']}\n                      />\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <Line \n                        type=\"monotone\" \n                        dataKey=\"threshold\" \n                        stroke={color} \n                        strokeWidth={2}\n                        dot={{ fill: color, strokeWidth: 2, r: 4 }}\n                        activeDot={{ r: 6 }}\n                      />\n                    </LineChart>\n                  </ResponsiveContainer>\n                  <div className=\"text-xs text-gray-600 mt-2\">\n                    データ数: {data.length}点\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\n// small UI helpers\nfunction Control({ label, children }) {\n  return (\n    <div>\n      <div className=\"text-gray-700 mb-1 text-base\">{label}</div>\n      {children}\n    </div>\n  );\n}\n\nfunction TinyToggle({ active, onClick, children }) {\n  return (\n    <button\n      onClick={onClick}\n      className={`px-3 py-2 rounded-lg border text-base ${active ? 'bg-black text-white border-black' : 'bg-white text-gray-800'}`}\n    >\n      {children}\n    </button>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}